fill="Particle size class") +
scale_fill_manual(values=c("burlywood3","seashell4","coral3"))  +
theme(text = element_text(size=14))
text.labs = c("Sand (%)","Silt (%)","Clay (%)")
df.stack.text = df.int[which(df.int$v %in% text.labs),]
df.stack.text$position = rep(0, nrow(df.stack.text))
df.stack.text$lower = rep(0, nrow(df.stack.text))
df.stack.text$upper = rep(0, nrow(df.stack.text))
for (i in 1:6) {
df.trt = df.stack.text[which(df.stack.text$t == trt.names[i]),]
trt.id = which(df.stack.text$t == trt.names[i])
df.trt$position = cumsum(df.trt[seq(3,1,-1),"mean"])[seq(3,1,-1)] - 1.5*df.trt$mean
df.stack.text[trt.id,"position"] = df.trt$position
df.stack.text[trt.id,"lower"] = (cumsum(df.trt[seq(3,1,-1),"mean"]) - (df.trt[seq(3,1,-1),"mean"]-df.trt[seq(3,1,-1),"5"]))[seq(3,1,-1)]
df.stack.text[trt.id,"upper"] = (cumsum(df.trt[seq(3,1,-1),"mean"]) + (df.trt[seq(3,1,-1),"95"]-df.trt[seq(3,1,-1),"mean"]))[seq(3,1,-1)]
}
text.labs.new = c("Sand (0.05-2.0 mm)","Silt (0.002-0.05 mm)","Clay (<0.002 mm)")
for (i in 1:3) { df.stack.text[which(df.stack.text$v == text.labs[i]),"v"]  = text.labs.new[i] }
p.text = ggplot(df.stack.text,
aes(y=factor(t, levels=trt.names), x=mean, fill=factor(v, levels=text.labs.new))) +
geom_bar(stat = "identity", position = "stack") +
geom_text(aes(label = round(mean,1)),
nudge_x = df.stack.text$position,
color = "white") +
labs(x="Posterior mean of relative mass (%)",y="",
fill="Particle size class") +
scale_fill_manual(values=c("burlywood3","seashell4","coral3"))  +
theme(text = element_text(size=14))
#geom_errorbar(aes(xmin=lower, xmax=upper), width=0.1)
p.text
meq.labs = c("K (meq)","Mg (meq)","Ca (meq)")
df.stack.meq = df.int[which(df.int$v %in% meq.labs),]
df.stack.meq$position = rep(0, nrow(df.stack.meq))
for (i in 1:6) {
df.trt = df.stack.meq[which(df.stack.meq$t == trt.names[i]),]
trt.id = which(df.stack.meq$t == trt.names[i])
df.trt$position = cumsum(df.trt[c(2,3,1),"mean"])[c(3,1,2)] - 1.5*df.trt$mean
df.stack.meq[trt.id,"position"] = df.trt$position
}
p.meq = ggplot(df.stack.meq, aes(y=factor(t, levels=trt.names), x=mean, fill=factor(v, levels=meq.labs))) +
geom_bar(stat="identity",position="stack") +
geom_text(aes(label = round(mean,1)),
nudge_x = df.stack.meq$position,
color="white") +
labs(x="Posterior mean of relative mass (%)",y="",fill="Aggregate size class") +
theme(axis.text.y = element_blank())
p.meq
var.set1 = c("Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)")
#ag.vars = c("Mean-weight diameter (mm)",">4.75 mm (% mass)","2 - 4.75 mm (% mass)",
#            "250 μm - 2 mm (% mass)","53 - 250 μm (% mass)","<53 μm (% mass)")
phys.vars = c(var.set1, ag.vars)
var.new
# compare organic and total carbon
c.labs = c("som","c")
var.labels
# compare organic and total carbon
c.labs = c("SOM (%)","TC (%)")
c.labs = c("SOM (%)","TC (%)")
df.stack.c = df.int[which(df.int$v %in% c.labs),]
df.stack.c$position = rep(0, nrow(df.stack.c))
for (i in 1:6) {
df.trt = df.stack.c[which(df.stack.c$t == trt.names[i]),]
trt.id = which(df.stack.c$t == trt.names[i])
df.trt$position = cumsum(df.trt[c(2,3,1),"mean"])[c(3,1,2)] - 1.5*df.trt$mean
df.stack.c[trt.id,"position"] = df.trt$position
}
c.labs = c("SOM (%)","TC (%)")
df.stack.c = df.int[which(df.int$v %in% c.labs),]
df.stack.c$position = rep(0, nrow(df.stack.c))
for (i in 1:6) {
df.trt = df.stack.c[which(df.stack.c$t == trt.names[i]),]
trt.id = which(df.stack.c$t == trt.names[i])
#df.trt$position = cumsum(df.trt[c(2,3,1),"mean"])[c(3,1,2)] - 1.5*df.trt$mean
#df.stack.c[trt.id,"position"] = df.trt$position
}
p.c = ggplot(df.stack.meq, aes(y=factor(t, levels=trt.names), x=mean,
fill=factor(v, levels=c.labs))) +
geom_bar(stat="identity",position="stack") +
#geom_text(aes(label = round(mean,1)),
#          nudge_x = df.stack.c$position,
#          color="white") +
labs(x="Posterior mean of relative mass (%)",y="",
fill="Aggregate size class") +
theme(axis.text.y = element_blank())
p.c
p.c = ggplot(df.stack.c, aes(y=factor(t, levels=trt.names), x=mean,
fill=factor(v, levels=c.labs))) +
geom_bar(stat="identity",position="stack") +
#geom_text(aes(label = round(mean,1)),
#          nudge_x = df.stack.c$position,
#          color="white") +
labs(x="Posterior mean of relative mass (%)",y="",
fill="Soil fraction")
p.c
View(df.stack.c)
df.trt
df.stack.c[which(df.stack.c$v == "SOM (%)"),"SOM (%)"]
View(df.stack.c)
df.stack.c[which(df.stack.c$v == "SOM (%)"),"SOM (%)"]
df.stack.c[which(df.stack.c$v == "SOM (%)"),"v"]
df.stack.c[which(df.stack.c$v == "SOM (%)"),"v"] = 0.5*df.stack.c[which(df.stack.c$v == "SOM (%)"),"v"]
df.stack.c[which(df.stack.c$v == "SOM (%)"),"v"]
df.trt[which(df.trt$v == "SOM (%)"),"v"]
df.stack.c = df.int[which(df.int$v %in% c.labs),]
omit.cols = c("v","t","sd")
c.labs = c("SOM (%)","TC (%)")
df.stack.c = df.int[which(df.int$v %in% c.labs),]
omit.cols = c("v","t","sd")
for (i in 1:6) {
df.trt = df.stack.c[which(df.stack.c$t == trt.names[i]),]
trt.id = which(df.stack.c$t == trt.names[i])
df.trt[which(df.trt$v == "SOM (%)"),-which(colnames(df.trt) %in% omit.cols)] = 0.5*df.trt[which(df.trt$v == "SOM (%)"),-which(colnames(df.trt) %in% omit.cols)]
}
View(df.trt)
View(df.stack.text)
View(df.trt)
df.stack.c$TIC = rep(0, nrow(df.stack.c))
length(df.trt)
df.tic = data.frame(matrix(nrow=1, ncol=length(df.trt)))
df.tic
clnames(df.tic) = colnames(df.trt)
colnames(df.tic) = colnames(df.trt)
df.tic
View(df.stack.c)
df.tc = df.trt[which(df.trt$v == "TC (%)"),]
df.tc
c.labs = c("SOM (%)","TC (%)")
df.stack.c = df.int[which(df.int$v %in% c.labs),]
omit.cols = c("v","t","sd")
omit.inds = which(colnames(df.stack.c) %in% omit.cols)
for (i in 1:6) {
trt.id = which(df.stack.c$t == trt.names[i])
df.trt = df.stack.c[trt.id,]
df.trt[which(df.trt$v == "SOM (%)"),omit.inds] = 0.5*df.trt[which(df.trt$v == "SOM (%)"),omit.inds]
df.tic = data.frame(matrix(nrow=1, ncol=length(df.trt)))
colnames(df.tic) = colnames(df.trt)
df.tic$v = "TIC (%)"
df.tc = df.trt[which(df.trt$v == "TC (%)"),]
df.soc = df.trt[which(df.trt$v == "SOM (%)"),]
df.tic[1,c("mean","5","95","15","85","25","75")] = df.tc - df.som
df.stack.c = rbind(df.stack.c, df.tic)
}
c.labs = c("SOM (%)","TC (%)")
df.stack.c = df.int[which(df.int$v %in% c.labs),]
omit.cols = c("v","t","sd")
omit.inds = which(colnames(df.stack.c) %in% omit.cols)
i = 1
df.trt = df.stack.c[which(df.stack.c$t == trt.names[i]),]
df.trt[which(df.trt$v == "SOM (%)"),omit.inds] = 0.5*df.trt[which(df.trt$v == "SOM (%)"),omit.inds]
omit.inds
df.trt[which(df.trt$v == "SOM (%)"),omit.inds]
c.labs = c("SOM (%)","TC (%)")
df.stack.c = df.int[which(df.int$v %in% c.labs),]
omit.cols = c("v","t","sd")
omit.inds = which(colnames(df.stack.c) %in% omit.cols)
for (i in 1:6) {
df.trt = df.stack.c[which(df.stack.c$t == trt.names[i]),]
df.trt[which(df.trt$v == "SOM (%)"),-omit.inds] = 0.5*df.trt[which(df.trt$v == "SOM (%)"),-omit.inds]
df.tic = data.frame(matrix(nrow=1, ncol=length(df.trt)))
colnames(df.tic) = colnames(df.trt)
df.tic$v = "TIC (%)"
df.tc = df.trt[which(df.trt$v == "TC (%)"),]
df.soc = df.trt[which(df.trt$v == "SOM (%)"),]
df.tic[1,c("mean","5","95","15","85","25","75")] = df.tc - df.som
df.stack.c = rbind(df.stack.c, df.tic)
}
c.labs = c("SOM (%)","TC (%)")
df.stack.c = df.int[which(df.int$v %in% c.labs),]
omit.cols = c("v","t","sd")
omit.inds = which(colnames(df.stack.c) %in% omit.cols)
for (i in 1:6) {
df.trt = df.stack.c[which(df.stack.c$t == trt.names[i]),]
df.trt[which(df.trt$v == "SOM (%)"),-omit.inds] = 0.5*df.trt[which(df.trt$v == "SOM (%)"),-omit.inds]
df.tic = data.frame(matrix(nrow=1, ncol=length(df.trt)))
colnames(df.tic) = colnames(df.trt)
df.tic$v = "TIC (%)"
df.tc = df.trt[which(df.trt$v == "TC (%)"),]
df.soc = df.trt[which(df.trt$v == "SOM (%)"),]
df.tic[1,c("mean","5","95","15","85","25","75")] = df.tc - df.soc
df.stack.c = rbind(df.stack.c, df.tic)
}
c.labs = c("SOM (%)","TC (%)")
df.stack.c = df.int[which(df.int$v %in% c.labs),]
omit.cols = c("v","t","sd")
omit.inds =
for (i in 1:6) {
df.trt = df.stack.c[which(df.stack.c$t == trt.names[i]),]
df.trt[which(df.trt$v == "SOM (%)"),-omit.inds] = 0.5*df.trt[which(df.trt$v == "SOM (%)"),-omit.inds]
df.tic = data.frame(matrix(nrow=1, ncol=length(df.trt)))
colnames(df.tic) = colnames(df.trt)
df.tic$v = "TIC (%)"
df.tc = df.trt[which(df.trt$v == "TC (%)"),]
df.soc = df.trt[which(df.trt$v == "SOM (%)"),]
df.tic[1,c("mean","5","95","15","85","25","75")] = df.tc[1,c("mean","5","95","15","85","25","75")] - df.soc[1,c("mean","5","95","15","85","25","75")]
df.stack.c = rbind(df.stack.c, df.tic)
}
View(df.stack.c)
c.labs = c("SOM (%)","TC (%)")
df.stack.c = df.int[which(df.int$v %in% c.labs),]
omit.cols = c("v","t","sd")
omit.inds =
for (i in 1:6) {
df.trt = df.stack.c[which(df.stack.c$t == trt.names[i]),]
df.trt[which(df.trt$v == "SOM (%)"),-omit.inds] = 0.5*df.trt[which(df.trt$v == "SOM (%)"),-omit.inds]
df.tic = data.frame(matrix(nrow=1, ncol=length(df.trt)))
colnames(df.tic) = colnames(df.trt)
df.tic$v = "TIC (%)"
df.tic$t = trt.names[i]
df.tc = df.trt[which(df.trt$v == "TC (%)"),]
df.soc = df.trt[which(df.trt$v == "SOM (%)"),]
df.tic[1,c("mean","5","95","15","85","25","75")] = df.tc[1,c("mean","5","95","15","85","25","75")] - df.soc[1,c("mean","5","95","15","85","25","75")]
df.stack.c = rbind(df.stack.c, df.tic)
}
c.labs = c("SOM (%)","TC (%)")
df.stack.c = df.int[which(df.int$v %in% c.labs),]
omit.cols = c("v","t","sd")
omit.inds = which(colnames(df.stack.c) %in% omit.cols)
for (i in 1:6) {
df.trt = df.stack.c[which(df.stack.c$t == trt.names[i]),]
df.trt[which(df.trt$v == "SOM (%)"),-omit.inds] = 0.5*df.trt[which(df.trt$v == "SOM (%)"),-omit.inds]
df.tic = data.frame(matrix(nrow=1, ncol=length(df.trt)))
colnames(df.tic) = colnames(df.trt)
df.tic$v = "TIC (%)"
df.tic$t = trt.names[i]
df.tc = df.trt[which(df.trt$v == "TC (%)"),]
df.soc = df.trt[which(df.trt$v == "SOM (%)"),]
df.tic[1,c("mean","5","95","15","85","25","75")] = df.tc[1,c("mean","5","95","15","85","25","75")] - df.soc[1,c("mean","5","95","15","85","25","75")]
df.stack.c = rbind(df.stack.c, df.tic)
}
View(df.stack.c)
p.c = ggplot(df.stack.c,
aes(y=factor(t, levels=trt.names), x=mean,
fill=factor(v, levels=c.labs))) +
geom_bar(stat="identity",position="stack") +
labs(x="Posterior mean of relative mass (%)",y="",
fill="Soil fraction")
p.c
c.labs = c("SOM (%)","TC (%)")
df.stack.c = df.int[which(df.int$v %in% c.labs),]
omit.cols = c("v","t","sd")
omit.inds = which(colnames(df.stack.c) %in% omit.cols)
for (i in 1:6) {
df.trt = df.stack.c[which(df.stack.c$t == trt.names[i]),]
df.trt[which(df.trt$v == "SOM (%)"),-omit.inds] = 0.5*df.trt[which(df.trt$v == "SOM (%)"),-omit.inds]
df.tic = data.frame(matrix(nrow=1, ncol=length(df.trt)))
colnames(df.tic) = colnames(df.trt)
df.tic$v = "TIC (%)"
df.tic$t = trt.names[i]
df.tc = df.trt[which(df.trt$v == "TC (%)"),]
df.soc = df.trt[which(df.trt$v == "SOM (%)"),]
df.tic[1,c("mean","5","95","15","85","25","75")] = df.tc[1,c("mean","5","95","15","85","25","75")] - df.soc[1,c("mean","5","95","15","85","25","75")]
df.stack.c = rbind(df.stack.c, df.tic)
}
df.stack.c[df.stack.c$v == "SOM (%)","v"] = "SOC (%)"
p.c = ggplot(df.stack.c[which(df.stack.c$v %in% c("SOC (%)","TIC (%)")),],
aes(y=factor(t, levels=trt.names), x=mean,
fill=factor(v, levels=c.labs))) +
geom_bar(stat="identity",position="stack") +
labs(x="Posterior mean of relative mass (%)",y="",
fill="Soil fraction")
p.c
df.stack.c[which(df.stack.c$v %in% c("SOC (%)","TIC (%)")),]
c.plot = c("SOC (%)","TIC (%)")
p.c = ggplot(df.stack.c[which(df.stack.c$v %in% c.plot),],
aes(y=factor(t, levels=trt.names), x=mean,
fill=factor(v, levels=c.plot))) +
geom_bar(stat="identity",position="stack") +
labs(x="Posterior mean of relative mass (%)",y="",
fill="Soil fraction")
p.c
c.plot = c("TIC (%)","SOC (%)")
p.c = ggplot(df.stack.c[which(df.stack.c$v %in% c.plot),],
aes(y=factor(t, levels=trt.names), x=mean,
fill=factor(v, levels=c.plot))) +
geom_bar(stat="identity",position="stack") +
labs(x="Posterior mean of relative mass (%)",y="",
fill="Soil fraction")
p.c
c.labs = c("SOM (%)","TC (%)")
df.stack.c = df.int[which(df.int$v %in% c.labs),]
omit.cols = c("v","t","sd")
omit.inds = which(colnames(df.stack.c) %in% omit.cols)
for (i in 1:6) {
df.trt = df.stack.c[which(df.stack.c$t == trt.names[i]),]
df.trt[which(df.trt$v == "SOM (%)"),-omit.inds] = 0.5*df.trt[which(df.trt$v == "SOM (%)"),-omit.inds]
df.tic = data.frame(matrix(nrow=1, ncol=length(df.trt)))
colnames(df.tic) = colnames(df.trt)
df.tic$v = "Inorganic (%)"
df.tic$t = trt.names[i]
df.tc = df.trt[which(df.trt$v == "TC (%)"),]
df.soc = df.trt[which(df.trt$v == "SOM (%)"),]
df.tic[1,c("mean","5","95","15","85","25","75")] = df.tc[1,c("mean","5","95","15","85","25","75")] - df.soc[1,c("mean","5","95","15","85","25","75")]
df.stack.c = rbind(df.stack.c, df.tic)
}
df.stack.c[df.stack.c$v == "SOM (%)","v"] = "Organic (%)"
c.plot = c("Inorganic (%)","Organic (%)")
p.c = ggplot(df.stack.c[which(df.stack.c$v %in% c.plot),],
aes(y=factor(t, levels=trt.names), x=mean,
fill=factor(v, levels=c.plot))) +
geom_bar(stat="identity",position="stack") +
labs(x="Posterior mean  (%)",y="",
fill="")
p.c
p.c = ggplot(df.stack.c[which(df.stack.c$v %in% c.plot),],
aes(y=factor(t, levels=trt.names), x=mean,
fill=factor(v, levels=c.plot))) +
geom_bar(stat="identity",position="stack") +
labs(x="Posterior mean  (%)",y="",
fill="", title="Carbon concentrations")
p.c
p.c = ggplot(df.stack.c[which(df.stack.c$v %in% c.plot),],
aes(y=factor(t, levels=trt.names), x=mean,
fill=factor(v, levels=c.plot))) +
geom_bar(stat="identity",position="stack") +
labs(x="Posterior mean (%)",y="",
fill="", title="Carbon oncentrations")
p.c
p.c = ggplot(df.stack.c[which(df.stack.c$v %in% c.plot),],
aes(y=factor(t, levels=trt.names), x=mean,
fill=factor(v, levels=c.plot))) +
geom_bar(stat="identity",position="stack") +
labs(x="Posterior mean (%)",y="",
fill="", title="Carbon concentrations")
p.c
stack.vars4 = c("Organic","Inorganic")
ipcc.vars = c("Annual crops","Revegetated cropland","Natural wetland")
p4 = ggplot(post.df.c[which(post.df.c$v %in% stack.vars4),],
aes(y=factor(t, levels=trt.names), x=mean, fill=v)) +
geom_bar(stat="identity",position="stack") +
scale_fill_manual(values=c("darkgray","darkorange4")) +
labs(fill="",y="",x="Posterior mean (Mg/ha)",title="Carbon stocks") +
geom_vline(data=SOC.est.df,
aes(xintercept=value, color=factor(`IPCC SOC`,levels=ipcc.vars)), size=1) +
scale_color_manual(values=c("red","green","blue")) +
guides(color = guide_legend(title = "IPCC soil organic carbon")) +
theme(text = element_text(size=14))
p4
p.c = ggplot(df.stack.c[which(df.stack.c$v %in% c.plot),],
aes(y=factor(t, levels=trt.names), x=mean,
fill=factor(v, levels=c.plot))) +
geom_bar(stat="identity",position="stack") +
labs(x="Posterior mean (%)",y="",
fill="", title="Carbon concentrations") +
scale_fill_manual(values=c("darkgray","darkorange4")) +
theme(text = element_text(size=14))
p.c
var.labs
var.new
var.labels
var.set1 = c("Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"pH","TN(%)","C:N Ratio","NH4 (ppm)",
"NO3 (ppm)","P (ppm","CED (meq/100 g)")
ggplot(df.int[which(df.int$v %in% var.set1),],
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`5`, xmax=`95`), width=0.25, color="black", position=position_dodge(width=0.5)) +
geom_errorbar(aes(xmin=`25`, xmax=`75`), width=0.25, color="blue", position=position_dodge(width=0.5)) +
geom_point(position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=var.set1), scales="free_x", ncol=3) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="")
var.set1 = c("Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"pH","TN (%)","C:N Ratio","NH4 (ppm)",
"NO3 (ppm)","P (ppm","CEC (meq/100 g)")
ggplot(df.int[which(df.int$v %in% var.set1),],
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`5`, xmax=`95`), width=0.25, color="black", position=position_dodge(width=0.5)) +
geom_errorbar(aes(xmin=`25`, xmax=`75`), width=0.25, color="blue", position=position_dodge(width=0.5)) +
geom_point(position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=var.set1), scales="free_x", ncol=3) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="")
ggplot(df.int[which(df.int$v %in% var.set1),],
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`5`, xmax=`95`), width=0.25, color="black", position=position_dodge(width=0.5)) +
geom_errorbar(aes(xmin=`25`, xmax=`75`), width=0.25, color="blue", position=position_dodge(width=0.5)) +
geom_point(position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=var.set1), scales="free_x", ncol=3) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="") + theme(text = element_text(size=14))
ggplot(df.int[which(df.int$v %in% var.set1),],
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`5`, xmax=`95`), width=0.25, color="black", position=position_dodge(width=0.5)) +
geom_errorbar(aes(xmin=`25`, xmax=`75`), width=0.25, color="blue", position=position_dodge(width=0.5)) +
geom_point(position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=var.set1), scales="free_x", ncol=3) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="") + theme(text = element_text(size=12))
c.plot = c("Organic (%)","Inorganic (%)")
p.c = ggplot(df.stack.c[which(df.stack.c$v %in% c.plot),],
aes(y=factor(t, levels=trt.names), x=mean,
fill=factor(v, levels=c.plot))) +
geom_bar(stat="identity",position="stack") +
labs(x="Posterior mean (%)",y="",
fill="", title="Carbon concentrations") +
scale_fill_manual(values=c("darkgray","darkorange4")) +
theme(text = element_text(size=14))
p.c
ggplot(df.stack.c, aes(x=mean, y=factor(t, levels=trt.names))) +
geom_errorbarh(aes(xmin=`5`,xmax=`95`,
y=factor(t, levels=trt.names)))
ggplot(df.stack.c, aes(x=mean, y=factor(t, levels=trt.names),
fill=factor(v, levels=c.plot))) +
geom_errorbarh(aes(xmin=`5`,xmax=`95`,
y=factor(t, levels=trt.names),
fill=factor(v, levels=c.plot)))
ggplot(df.stack.c, aes(x=mean, y=factor(t, levels=trt.names),
color=factor(v, levels=c.plot))) +
geom_point(position=position_dodge(0.5)) +
geom_errorbarh(aes(xmin=`5`,xmax=`95`,
y=factor(t, levels=trt.names),
color=factor(v, levels=c.plot)))
ggplot(df.stack.c, aes(x=mean, y=factor(t, levels=trt.names),
color=factor(v, levels=c.plot))) +
geom_point(position=position_dodge(0.5)) +
geom_errorbarh(aes(xmin=`5`,xmax=`95`,
y=factor(t, levels=trt.names),
color=factor(v, levels=c.plot)),
position=position_dodge(0.5))
View(df.stack.c)
c.plot2 = c("Organic (%)","Inorganic (%)","TC (%)")
ggplot(df.stack.c, aes(x=mean, y=factor(t, levels=trt.names),
color=factor(v, levels=c.plot2))) +
geom_point(position=position_dodge(0.5)) +
geom_errorbarh(aes(xmin=`5`,xmax=`95`,
y=factor(t, levels=trt.names),
color=factor(v, levels=c.plot2)),
position=position_dodge(0.5))
c.labs = c("SOM (%)","TC (%)")
df.stack.c = df.int[which(df.int$v %in% c.labs),]
omit.cols = c("v","t","sd")
omit.inds = which(colnames(df.stack.c) %in% omit.cols)
for (i in 1:6) {
df.trt = df.stack.c[which(df.stack.c$t == trt.names[i]),]
df.trt[which(df.trt$v == "SOM (%)"),-omit.inds] = 0.5*df.trt[which(df.trt$v == "SOM (%)"),-omit.inds]
df.tic = data.frame(matrix(nrow=1, ncol=length(df.trt)))
colnames(df.tic) = colnames(df.trt)
df.tic$v = "Inorganic (%)"
df.tic$t = trt.names[i]
df.tc = df.trt[which(df.trt$v == "TC (%)"),]
df.soc = df.trt[which(df.trt$v == "SOM (%)"),]
df.tic[1,c("mean","5","95","15","85","25","75")] = df.tc[1,c("mean","5","95","15","85","25","75")] - df.soc[1,c("mean","5","95","15","85","25","75")]
df.stack.c = rbind(df.stack.c, df.tic)
}
df.stack.c[df.stack.c$v == "SOM (%)","v"] = "Organic (%)"
c.plot2 = c("Organic (%)","Inorganic (%)","TC (%)")
ggplot(df.stack.c, aes(x=mean, y=factor(t, levels=trt.names),
color=factor(v, levels=c.plot2))) +
geom_point(position=position_dodge(0.5)) +
geom_errorbarh(aes(xmin=`5`,xmax=`95`,
y=factor(t, levels=trt.names),
color=factor(v, levels=c.plot2)),
position=position_dodge(0.5))
df.stack.c = df.int[which(df.int$v %in% c.labs),]
c.labs = c("SOM (%)","TC (%)")
df.stack.c = df.int[which(df.int$v %in% c.labs),]
omit.cols = c("v","t","sd")
omit.inds = which(colnames(df.stack.c) %in% omit.cols)
df.stack.c[which(df.stack.c$v == "SOM (%)"),-omit.inds] = 0.5*df.stack.c[which(df.stack.c$v == "SOM (%)"),-omit.inds]
c.labs = c("SOM (%)","TC (%)")
df.stack.c = df.int[which(df.int$v %in% c.labs),]
omit.cols = c("v","t","sd")
omit.inds = which(colnames(df.stack.c) %in% omit.cols)
df.stack.c[which(df.stack.c$v == "SOM (%)"),-omit.inds] = 0.5*df.stack.c[which(df.stack.c$v == "SOM (%)"),-omit.inds]
for (i in 1:6) {
df.trt = df.stack.c[which(df.stack.c$t == trt.names[i]),]
df.tic = data.frame(matrix(nrow=1, ncol=length(df.trt)))
colnames(df.tic) = colnames(df.trt)
df.tic$v = "Inorganic (%)"
df.tic$t = trt.names[i]
df.tc = df.trt[which(df.trt$v == "TC (%)"),]
df.soc = df.trt[which(df.trt$v == "SOM (%)"),]
df.tic[1,c("mean","5","95","15","85","25","75")] = df.tc[1,c("mean","5","95","15","85","25","75")] - df.soc[1,c("mean","5","95","15","85","25","75")]
df.stack.c = rbind(df.stack.c, df.tic)
}
df.stack.c[df.stack.c$v == "SOM (%)","v"] = "Organic (%)"
c.plot = c("Organic (%)","Inorganic (%)")
p.c = ggplot(df.stack.c[which(df.stack.c$v %in% c.plot),],
aes(y=factor(t, levels=trt.names), x=mean,
fill=factor(v, levels=c.plot))) +
geom_bar(stat="identity",position="stack") +
labs(x="Posterior mean (%)",y="",
fill="", title="Carbon concentrations") +
scale_fill_manual(values=c("darkgray","darkorange4")) +
theme(text = element_text(size=14))
p.c
c.plot = c("Inorganic (%)","Organic (%)")
p.c = ggplot(df.stack.c[which(df.stack.c$v %in% c.plot),],
aes(y=factor(t, levels=trt.names), x=mean,
fill=factor(v, levels=c.plot))) +
geom_bar(stat="identity",position="stack") +
labs(x="Posterior mean (%)",y="",
fill="", title="Carbon concentrations") +
scale_fill_manual(values=c("darkgray","darkorange4")) +
theme(text = element_text(size=14))
p.c
c.plot2 = c("Organic (%)","Inorganic (%)","TC (%)")
ggplot(df.stack.c, aes(x=mean, y=factor(t, levels=trt.names),
color=factor(v, levels=c.plot2))) +
geom_point(position=position_dodge(0.5)) +
geom_errorbarh(aes(xmin=`5`,xmax=`95`,
y=factor(t, levels=trt.names),
color=factor(v, levels=c.plot2)),
position=position_dodge(0.5))
ggplot(df.stack.c[which(df.stack.c$v == c.plot2[2]),],
aes(x=mean, y=factor(t, levels=trt.names),
color=factor(v, levels=c.plot2[2]))) +
geom_point(position=position_dodge(0.5)) +
geom_errorbarh(aes(xmin=`5`,xmax=`95`,
y=factor(t, levels=trt.names),
color=factor(v, levels=c.plot2[2])),
position=position_dodge(0.5))
View(soil.dat)
