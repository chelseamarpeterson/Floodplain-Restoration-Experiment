position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=var.labels),
scales="free_x", ncol=4) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="Posterior estimate") +
theme(text = element_text(size=12))
p.chem.phys
p.chem.phys = ggplot(df.plot,
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`X5`, xmax=`X95`),
width=0.25, color="black",
position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=var.labels),
scales="free_x", ncol=5) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="Posterior estimate") +
theme(text = element_text(size=12))
p.chem.phys
vars = c("Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"Sand (%)","Silt (%)","Clay (%)","pH",
"TN (%)","C:N Ratio","NO3 (ppm)","NH4 (ppm)","P (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)","CEC (meq/100 g)",
">4.75 mm","2 - 4.75 mm","250 \u03bcm - 2 mm","53 - 250 \u03bcm",
"<53 \u03bcm","Mean-weight diameter (mm)")
df.plot = df.int[which(df.int$v %in% vars),]
p.chem.phys = ggplot(df.plot,
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`X5`, xmax=`X95`),
width=0.25, color="black",
position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=var.labels),
scales="free_x", ncol=4) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="Posterior estimate") +
theme(text = element_text(size=12))
p.chem.phys
vars = c("Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"Sand (%)","Silt (%)","Clay (%)","pH",
"TN (%)","C:N Ratio","NO3 (ppm)","NH4 (ppm)","P (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)","CEC (meq/100 g)",
">4.75 mm","2 - 4.75 mm","250 \u03bcm - 2 mm","53 - 250 \u03bcm",
"<53 \u03bcm","Mean-weight diameter (mm)")
df.plot = df.int[which(df.int$v %in% vars),]
p.chem.phys = ggplot(df.plot,
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`X5`, xmax=`X95`),
width=0.25, color="black",
position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=vars),
scales="free_x", ncol=4) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="Posterior estimate") +
theme(text = element_text(size=12))
p.chem.phys
vars = c("Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)","pH",
"Sand (%)","Silt (%)","Clay (%)",
"TN (%)","C:N Ratio","NO3 (ppm)","NH4 (ppm)","P (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)","CEC (meq/100 g)",
">4.75 mm","2 - 4.75 mm","250 \u03bcm - 2 mm","53 - 250 \u03bcm",
"<53 \u03bcm","Mean-weight diameter (mm)")
df.plot = df.int[which(df.int$v %in% vars),]
p.chem.phys = ggplot(df.plot,
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`X5`, xmax=`X95`),
width=0.25, color="black",
position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=vars),
scales="free_x", ncol=4) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="Posterior estimate") +
theme(text = element_text(size=12))
p.chem.phys
vars = c("Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"Mean-weight diameter (mm)","pH","Sand (%)","Silt (%)","Clay (%)",
"TN (%)","C:N Ratio","NO3 (ppm)","NH4 (ppm)","P (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)","CEC (meq/100 g)",
">4.75 mm","2 - 4.75 mm","250 \u03bcm - 2 mm","53 - 250 \u03bcm",
"<53 \u03bcm")
df.plot = df.int[which(df.int$v %in% vars),]
p.chem.phys = ggplot(df.plot,
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`X5`, xmax=`X95`),
width=0.25, color="black",
position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=vars),
scales="free_x", ncol=4) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="Posterior estimate") +
theme(text = element_text(size=12))
p.chem.phys
vars = c("Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"Mean-weight diameter (mm)","pH","Sand (%)","Silt (%)","Clay (%)",
"TN (%)","C:N Ratio","NO3 (ppm)","NH4 (ppm)","P (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)","CEC (meq/100 g)",
">4.75 mm","2 - 4.75 mm","250 \u03bcm - 2 mm","53 - 250 \u03bcm",
"<53 \u03bcm")
df.plot = df.int[which(df.int$v %in% vars),]
p.chem.phys = ggplot(df.plot,
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`X5`, xmax=`X95`),
width=0.25, color="black",
position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=vars),
scales="free_x", ncol=5) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="Posterior estimate") +
theme(text = element_text(size=12))
p.chem.phys
p.chem.phys = ggplot(df.plot,
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`X5`, xmax=`X95`),
width=0.25, color="black",
position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=vars),
scales="free_x", ncol=4) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="Posterior estimate") +
theme(text = element_text(size=12))
p.chem.phys
vars = c("Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"pH","Sand (%)","Silt (%)","Clay (%)",
"TN (%)","C:N Ratio","NO3 (ppm)","NH4 (ppm)","P (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)",">4.75 mm","2 - 4.75 mm",
"250 \u03bcm - 2 mm","53 - 250 \u03bcm","<53 \u03bcm")
df.plot = df.int[which(df.int$v %in% vars),]
p.chem.phys = ggplot(df.plot,
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`X5`, xmax=`X95`),
width=0.25, color="black",
position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=vars),
scales="free_x", ncol=4) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="Posterior estimate") +
theme(text = element_text(size=12))
p.chem.phys
p.chem.phys = ggplot(df.plot,
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`X5`, xmax=`X95`),
width=0.25, color="black",
position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=vars),
scales="free_x", ncol=5) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="Posterior estimate") +
theme(text = element_text(size=12))
p.chem.phys
vars = c("Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"Sand (%)","Silt (%)","Clay (%)","TN (%)","C:N Ratio",
"pH","NO3 (ppm)","NH4 (ppm)","P (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)",">4.75 mm","2 - 4.75 mm",
"250 \u03bcm - 2 mm","53 - 250 \u03bcm","<53 \u03bcm")
df.plot = df.int[which(df.int$v %in% vars),]
p.chem.phys = ggplot(df.plot,
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`X5`, xmax=`X95`),
width=0.25, color="black",
position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=vars),
scales="free_x", ncol=5) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="Posterior estimate") +
theme(text = element_text(size=12))
p.chem.phys
vars = c("Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"TN (%)","C:N Ratio","Sand (%)","Silt (%)","Clay (%)",
"pH","NO3 (ppm)","NH4 (ppm)","P (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)",">4.75 mm","2 - 4.75 mm",
"250 \u03bcm - 2 mm","53 - 250 \u03bcm","<53 \u03bcm")
df.plot = df.int[which(df.int$v %in% vars),]
p.chem.phys = ggplot(df.plot,
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`X5`, xmax=`X95`),
width=0.25, color="black",
position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=vars),
scales="free_x", ncol=5) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="Posterior estimate") +
theme(text = element_text(size=12))
p.chem.phys
ggsave("Figures/Figure4_Nutrients_BD_Temp_Moisture_pH.jpeg",
plot=p.chem.phys,width=17.5,height=15,units="cm",dpi=600)
vars = c("Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"TN (%)","C:N Ratio","Sand (%)","Silt (%)","Clay (%)",
"pH","P (ppm)","NO3 (ppm)","NH4 (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)",">4.75 mm","2 - 4.75 mm",
"250 \u03bcm - 2 mm","53 - 250 \u03bcm","<53 \u03bcm")
df.plot = df.int[which(df.int$v %in% vars),]
p.chem.phys = ggplot(df.plot,
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`X5`, xmax=`X95`),
width=0.25, color="black",
position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=vars),
scales="free_x", ncol=5) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="Posterior estimate") +
theme(text = element_text(size=12))
p.chem.phys
ggsave("Figures/Figure4_All_Except_CEC_MWD.jpeg",
plot=p.chem.phys,width=17.5,height=15,units="cm",dpi=600)
ggsave("Figures/Figure4_All_Except_CEC_MWD.jpeg",
plot=p.chem.phys,width=20,height=15,units="cm",dpi=600)
ggsave("Figures/Figure4_All_Except_CEC_MWD.jpeg",
plot=p.chem.phys,width=25,height=15,units="cm",dpi=600)
ggsave("Figures/Figure4_All_Except_CEC_MWD.jpeg",
plot=p.chem.phys,width=27,height=18,units="cm",dpi=600)
p.chem.phys = ggplot(df.plot,
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`X5`, xmax=`X95`),
width=0.25, color="black",
position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=vars),
scales="free_x", ncol=5) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="Posterior estimate") +
theme(text = element_text(size=12))  +
scale_x_continuous(breaks = breaks_pretty(n=4))
install.packages("scales")
install.packages("scales")
vars = c("Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"TN (%)","C:N Ratio","Sand (%)","Silt (%)","Clay (%)",
"pH","P (ppm)","NO3 (ppm)","NH4 (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)",">4.75 mm","2 - 4.75 mm",
"250 \u03bcm - 2 mm","53 - 250 \u03bcm","<53 \u03bcm")
labs = c("Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"TN (%)","C:N Ratio","Sand (%)","Silt (%)","Clay (%)",
"pH","P (ppm)","NO3-N (ppm)","NH4-N (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)",">4.75 mm","2 - 4.75 mm",
"250 \u03bcm - 2 mm","53 - 250 \u03bcm","<53 \u03bcm")
library(ggtext)
library(scales)
path_to_soil_folder = "C:/Users/Chels/OneDrive - University of Illinois - Urbana/Chapter2/Floodplain-Experiment-Repo"
setwd(path_to_soil_folder)
library(ggplot2)
library(patchwork)
library(RColorBrewer)
# treatment names
trts = c("A","B","C","D","E","R")
trt.names = c("Balled-and-burlapped","Bareroot","Seedling","Acorn","Seedbank","Reference")
# variable labels
var.labels = c("SOM (%)","TOC (%)","TIC (%)","POC (%)","MAOC (%)","TC (%)","TN (%)","C:N Ratio",
"Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"Sand (%)","Silt (%)","Clay (%)","NO3 (ppm)","NH4 (ppm)","P (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)","K (meq)","Ca (meq)","Mg (meq)",
"CEC (meq/100 g)","pH","Floating POM",
">4.75 mm","2 - 4.75 mm","250 \u03bcm - 2 mm","53 - 250 \u03bcm",
"<53 \u03bcm","Mean-weight diameter (mm)")
# read in HPDIs
df.soil = read.csv("Soil_Analysis/Posteriors/All_Soil_Posterior_Intervals_ChainCount5.csv")
# print results for tables
i = 33
cbind(df.soil[which(df.soil$v == var.labels[i]),c("v","t")],
round(df.soil[which(df.soil$v == var.labels[i]),c("mean","X5","X95")],1))
cbind(df.soil[which(df.soil$v == var.labels[i]),c("v","t")],
round(df.soil[which(df.soil$v == var.labels[i]),c("mean","X5","X95")],2))
cbind(df.soil[which(df.soil$v == var.labels[i]),c("v","t")],
round(df.soil[which(df.soil$v == var.labels[i]),c("mean","X5","X95")],3))
## make combined plot for CEC, carbon fractions, texture, and aggregates
# stacked plot for aggregate size distribution
t.size = 14
ag.labs = c(">4.75 mm","2 - 4.75 mm","250 \u03bcm - 2 mm","53 - 250 \u03bcm","<53 \u03bcm")
df.stack.ag = df.soil[which(df.soil$v %in% ag.labs),]
df.stack.ag$position = rep(0, nrow(df.stack.ag))
for (i in 1:6) {
df.trt = df.stack.ag[which(df.stack.ag$t == trt.names[i]),]
trt.id = which(df.stack.ag$t == trt.names[i])
df.trt$position = cumsum(df.trt[seq(5,1,-1),"mean"])[seq(5,1,-1)] - 1.5*df.trt$mean
df.stack.ag[trt.id,"position"] = df.trt$position
}
ag.labs.new = c(">4.75 mm","2-4.75 mm","0.250-2 mm","0.053-0.250 mm","<0.053 mm")
df.stack.ag$lab = rep(0, nrow(df.stack.ag))
for (i in 1:5) {  df.stack.ag$lab[which(df.stack.ag$v == ag.labs[i])]  = ag.labs.new[i]  }
ag.palette <- tail(brewer.pal(12,"Blues"),5)
p.ag = ggplot(df.stack.ag, aes(y=factor(t, levels=trt.names),
x=mean,
fill=factor(lab, levels=ag.labs.new))) +
geom_bar(stat="identity",position="stack") +
geom_label(aes(label = round(mean,1)),
nudge_x = df.stack.ag$position,
color="white",
size=2.5, show.legend = FALSE) +
labs(x="Percent of total mass (%)",
y="",fill="Aggregate size class") +
scale_fill_manual(values=ag.palette) +
theme(text=element_text(size=t.size),
axis.text.y = element_blank()) +
coord_cartesian(xlim = c(0,100), clip="off") +
theme(plot.margin=unit(c(1,1,1,1),"lines")) +
geom_label(x=111.4,y=6.3,label="d",
color="black",fill=alpha("white",0.9),
label.r=unit(0,"pt"),label.size=0,
size=8,fontface="bold")
# stacked plot for particle size distribution
text.labs = c("Sand (%)","Silt (%)","Clay (%)")
df.stack.text = df.soil[which(df.soil$v %in% text.labs),]
df.stack.text$position = rep(0, nrow(df.stack.text))
df.stack.text$lower = rep(0, nrow(df.stack.text))
df.stack.text$upper = rep(0, nrow(df.stack.text))
for (i in 1:6) {
df.trt = df.stack.text[which(df.stack.text$t == trt.names[i]),]
trt.id = which(df.stack.text$t == trt.names[i])
df.trt$position = cumsum(df.trt[seq(3,1,-1),"mean"])[seq(3,1,-1)] - 1.5*df.trt$mean
df.stack.text[trt.id,"position"] = df.trt$position
df.stack.text[trt.id,"lower"] = (cumsum(df.trt[seq(3,1,-1),"mean"]) - (df.trt[seq(3,1,-1),"mean"]-df.trt[seq(3,1,-1),"5"]))[seq(3,1,-1)]
df.stack.text[trt.id,"upper"] = (cumsum(df.trt[seq(3,1,-1),"mean"]) + (df.trt[seq(3,1,-1),"95"]-df.trt[seq(3,1,-1),"mean"]))[seq(3,1,-1)]
}
text.labs.new = c("Sand (0.05-2.0 mm)","Silt (0.002-0.05 mm)","Clay (<0.002 mm)")
df.stack.text$lab = rep(0, nrow(df.stack.text))
for (i in 1:3) { df.stack.text$lab[which(df.stack.text$v == text.labs[i])] = text.labs.new[i] }
text.palette <- tail(brewer.pal(7,"BuPu"),3)
p.text = ggplot(df.stack.text,
aes(y=factor(t, levels=trt.names),
x=mean,
fill=factor(lab, levels=text.labs.new))) +
geom_bar(stat = "identity", position = "stack") +
geom_label(aes(label = round(mean,1)),
nudge_x = df.stack.text$position,
color="white",#fill="white",
size=2.5, show.legend = FALSE) +
labs(x="Percent of total mass (%)",y="",
fill="Particle size class") +
scale_fill_manual(values=text.palette) +
theme(text = element_text(size=t.size)) +
coord_cartesian(xlim = c(0,100), clip="off") +
theme(plot.margin=unit(c(1,1,1,1),"lines")) +
geom_label(x=111.1,y=6.3,label="c",
color="black",fill=alpha("white",0.9),
label.r=unit(0,"pt"),label.size=0,
size=8,fontface="bold")
# stacked plot for carbon fractions
c.labs = c("TIC (%)","POC (%)","MAOC (%)")
df.stack.c = df.soil[which(df.soil$v %in% c.labs),]
df.stack.c$position = rep(0, nrow(df.stack.c))
for (i in 1:6) {
df.trt = df.stack.c[which(df.stack.c$t == trt.names[i]),]
trt.id = which(df.stack.c$t == trt.names[i])
df.trt$position = cumsum(df.trt[seq(3,1,-1),"mean"])[seq(3,1,-1)] - 1.5*df.trt$mean
df.stack.c[trt.id,"position"] = df.trt$position
}
c.labs.new = c("TIC","POC","MAOC")
df.stack.c$lab = rep(0, nrow(df.stack.c))
for (i in 1:3) { df.stack.c$lab[which(df.stack.c$v == c.labs[i])] = c.labs.new[i] }
c.palette <- tail(brewer.pal(6,"Oranges"),3)
p.c = ggplot(df.stack.c[which(df.stack.c$v %in% c.labs),],
aes(y=factor(t, levels=trt.names), x=mean,
fill=factor(lab, levels=c.labs.new))) +
geom_bar(stat="identity",position="stack") +
geom_label(aes(label = round(mean,1)),
nudge_x = df.stack.c$position,
color="white",#fill="white",
size=2.5, show.legend = FALSE) +
labs(x="Concentration (% [g C/g soil])",
y="",fill="Soil carbon fraction") +
scale_fill_manual(values=c.palette) +
theme(text = element_text(size=t.size)) +
coord_cartesian(xlim = c(0,4.6), clip="off") +
theme(plot.margin=unit(c(1,1,1,1),"lines")) +
geom_label(x=5.12,y=6.3,label="a",
color="black",fill=alpha("white",0.9),
label.r=unit(0,"pt"),label.size=0,
size=8,fontface="bold")
# stacked plot for cation exchange
meq.labs = c("K (meq)","Mg (meq)","Ca (meq)")
df.stack.meq = df.soil[which(df.soil$v %in% meq.labs),]
df.stack.meq$position = rep(0, nrow(df.stack.meq))
for (i in 1:6) {
df.trt = df.stack.meq[which(df.stack.meq$t == trt.names[i]),]
trt.id = which(df.stack.meq$t == trt.names[i])
df.trt$position = cumsum(df.trt[c(2,3,1),"mean"])[c(3,1,2)] - 1.5*df.trt$mean
df.stack.meq[trt.id,"position"] = df.trt$position
}
meq.labs.new = c("K","Mg","Ca")
df.stack.meq$lab = rep(0, nrow(df.stack.meq))
for (i in 1:3) { df.stack.meq$lab[which(df.stack.meq$v == meq.labs[i])] = meq.labs.new[i] }
meq.palette <- tail(brewer.pal(7,"YlGn"),3)
p.meq = ggplot(df.stack.meq, aes(x=mean,
y=factor(t, levels=trt.names),
fill=factor(lab, levels=meq.labs.new))) +
geom_bar(stat="identity",position="stack") +
geom_label(aes(label = round(mean,1)),
nudge_x = df.stack.meq$position,
color="white",
size=2.5, show.legend=FALSE) +
labs(x="Contribution to CEC (meq/100 g)",y="",
fill="Cation") +
scale_fill_manual(values=meq.palette) +
theme(text = element_text(size=t.size),
axis.text.y = element_blank()) +
coord_cartesian(xlim = c(0,41), clip="off") +
theme(plot.margin=unit(c(1,1,1,1),"lines")) +
geom_label(x=45.7,y=6.3,label="b",
color="black",fill=alpha("white",0.9),
label.r=unit(0,"pt"),label.size=0,
size=8,fontface="bold")
p.upper = p.c + p.meq + plot_spacer() + plot_layout(widths=c(0.5,0.5,0))
p.lower = p.text + p.ag + plot_spacer() + plot_layout(widths=c(0.5,0.5,0))
p.all =  p.upper/p.lower +
plot_layout(guides = "collect") +
theme(legend.position = "right",
plot.margin = unit(c(0,0,0,0),"mm"))
p.all
ggsave("Figures/Figure3_Carbon_CEC_Texture_Aggregates.jpeg",
plot=p.all, width=30, height=20, units="cm",dpi=600)
################################################################################
# plot all chemical and physical variables
library(ggtext)
library(scales)
# plot all variables
ggplot(df.soil, aes(y=factor(t, levels=trt.names),
x=mean)) +
geom_errorbarh(aes(xmin=X5, xmax=X95), color="black") +
geom_point() +
facet_wrap(.~v, scales="free_x",ncol=5)
# plot select variables on absolute scale
vars = c("Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"TN (%)","C:N Ratio","Sand (%)","Silt (%)","Clay (%)",
"pH","P (ppm)","NO3 (ppm)","NH4 (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)",">4.75 mm","2 - 4.75 mm",
"250 \u03bcm - 2 mm","53 - 250 \u03bcm","<53 \u03bcm")
labs = c("Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"TN (%)","C:N Ratio","Sand (%)","Silt (%)","Clay (%)",
"pH","P (ppm)","NO3-N (ppm)","NH4-N (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)",">4.75 mm","2 - 4.75 mm",
"250 \u03bcm - 2 mm","53 - 250 \u03bcm","<53 \u03bcm")
df.plot = df.soil[which(df.soil$v %in% vars),]
df.plot$label = rep(0, nrow(df.plot))
for (i in 1:length(vars)) { df.plot$label[which(df.plot$v == vars[i])] = labs[i] }
p.chem.phys = ggplot(df.plot,
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`X5`, xmax=`X95`),
width=0.25, color="black",
position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=vars),
scales="free_x", ncol=5) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="Posterior estimate") +
theme(text = element_text(size=12))  +
scale_x_continuous(breaks = breaks_pretty(n=4))
p.chem.phys
ggsave("Figures/Figure4_All_Except_CEC_MWD.jpeg",
plot=p.chem.phys,width=27,height=18,units="cm",dpi=600)
p.chem.phys = ggplot(df.plot,
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`X5`, xmax=`X95`),
width=0.25, color="black",
position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=vars),
scales="free_x", ncol=5) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="Posterior estimate") +
theme(text = element_text(size=12))  +
scale_x_continuous(breaks = breaks_pretty(n=4))
p.chem.phys
ggplot(df.plot,
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`X5`, xmax=`X95`),
width=0.25, color="black",
position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=vars),
scales="free_x", ncol=5) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="Posterior estimate") +
theme(text = element_text(size=12))  +
scale_x_continuous(breaks = breaks_pretty(n=4))
vars = c("Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"TN (%)","C:N Ratio","Sand (%)","Silt (%)","Clay (%)",
"pH","P (ppm)","NO3 (ppm)","NH4 (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)",">4.75 mm","2 - 4.75 mm",
"250 \u03bcm - 2 mm","53 - 250 \u03bcm","<53 \u03bcm")
labs = c("Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"TN (%)","C:N Ratio","Sand (%)","Silt (%)","Clay (%)",
"pH","P (ppm)","NO3-N (ppm)","NH4-N (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)",">4.75 mm","2 - 4.75 mm",
"250 \u03bcm - 2 mm","53 - 250 \u03bcm","<53 \u03bcm")
df.plot = df.soil[which(df.soil$v %in% vars),]
df.plot$label = rep(0, nrow(df.plot))
for (i in 1:length(vars)) { df.plot$label[which(df.plot$v == vars[i])] = labs[i] }
ggplot(df.plot, aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`X5`, xmax=`X95`),
width=0.25, color="black",
position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=vars),
scales="free_x", ncol=5) +
theme(panel.spacing.x = unit(0.4, "cm"),
text = element_text(size=12)) +
labs(y="",x="Posterior estimate")
p.chem.phys
ggplot(df.soil, aes(y=factor(t, levels=trt.names),
x=mean)) +
geom_errorbarh(aes(xmin=X5, xmax=X95), color="black") +
geom_point() +
facet_wrap(.~v, scales="free_x",ncol=5)
