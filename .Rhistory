library(reshape2)
library(ggpattern)
# water regimes / wetland flood frequency cutoffs
water.regimes = c("Permanently Flooded","Intermittently Exposed",
"Semipermanently Flooded","Seasonally Flooded/Saturated",
"Seasonally Flooded","Seasonally Saturated",
"Temporary Flooded","Intermittently Flooded")
water.reg.labels = c("Permanently Flooded","Intermittently Exposed",
"Semipermanently Flooded","Seasonally Flooded/Saturated",
"Seasonally Flooded","Seasonally Saturated",
"Temporarily Flooded","Intermittently Flooded")
n.w = length(water.regimes)
# stream flow permanence criteria
perm.levels = c("Perennial","Intermittent","Ephemeral")
perm.abrvs = c("1","2","3")
n.p = length(perm.abrvs)
# make vectors for buffer scenarios
buf.dists = c("1","10","20","100")
buf.cols = paste("buf", buf.dists, sep="")
n.b = length(buf.dists)
nwi.df = read.csv("IL_WS_Step11_AreaThreshold.csv")
du.df = read.csv("Step10_DU_IL_AreaThreshold.csv")
# update du column name
colnames(du.df)[which(colnames(du.df) == "WETLAND_TY")] = "WETLAND_TYPE"
# compare total areas
sum(nwi.df$Area_Ha)
sum(du.df$Area_Ha)
# datasets
datasets = c("Original NWI - NHD Plus","Original NWI - Brinkerhoff",
"Ducks Unlimited - NHD Plus","Ducks Unlimited - Brinkerhoff")
# calculate non-WOTUS area
area.df = data.frame(matrix(nrow=4*n.w*n.p*n.b, ncol=16))
colnames(area.df) = c("datasets","water_cutoff","perm_level","buf_dist","area","delta_area",
"leveed_only","non_intersect_only","below_flood_only",
"leveed_and_non_intersect","leveed_and_below_flood",
"non_intersect_and_below_flood","leveed_non_intersect_below_flood",
"pond","emergent","forest")
n = 1
for (d in 1:4) {
if (d %in% c(1,2)) {
ws.df = nwi.df
if (d == 1) {
waters = "Waters_Intersect"
} else if (d == 2) {
waters = "Brinkerhoff_Intersect"
}
} else if (d %in% c(3,4)) {
ws.df = du.df
if (d == 3) {
waters = "Waters_Intersect"
} else if (d == 4) {
waters = "Brinkerhoff_Intersect"
}
}
for (i in 1:n.w) {
for (j in 1:n.p) {
for (k in 1:n.b) {
# dataset
area.df[n,"dataset"] = datasets[d]
# assign policy scenario labels
area.df[n,"water_cutoff"] = water.regimes[i]
area.df[n,"perm_level"] = perm.levels[j]
area.df[n,"buf_dist"] = buf.dists[k]
# create column for flow permanence and buffer distance combination
buf.ws.col = paste(waters, perm.abrvs[j], buf.dists[k], sep="_")
# get all water regimes up to the ith and then identify rows with insufficient flooding
wrs1 = water.regimes[1:i]
wrs.inds1 = !(ws.df$WATER_REGI %in% wrs1)
# identify all wetland polygons that (1) don't meet the flood frequency cutoff,
# (2) occur within a leveed area, or (3) don't intersect the WOTUS buffer
area1 = sum(ws.df[which(wrs.inds1 | (ws.df$Within_Levee == 1 | ws.df[,buf.ws.col] == 0)),"Area_Ha"])
area.df[n,"area"] = area1
# calculate the incremental increase in non-WOTUS area relative to less strict
# flood frequency cutoff
if (i < n.w) {
wrs2 = water.regimes[1:(i+1)]
wrs.inds2 = !(ws.df$WATER_REGI %in% wrs2)
area2 = sum(ws.df[which(wrs.inds2 | (ws.df$Within_Levee == 1 | ws.df[,buf.ws.col] == 0)),"Area_Ha"])
area.df[n,"delta_area"] = area1 - area2
} else {
area.df[n,"delta_area"] = 0
}
# calculate cumulative non-WOTUS area by reason for loss of jurisdiction
area.df[n,"leveed_only"] = sum(ws.df[which(!wrs.inds1 & (ws.df$Within_Levee == 1 & ws.df[,buf.ws.col] == 1)),"Area_Ha"])
area.df[n,"non_intersect_only"] = sum(ws.df[which(!wrs.inds1 & (ws.df$Within_Levee == 0 & ws.df[,buf.ws.col] == 0)),"Area_Ha"])
area.df[n,"leveed_and_non_intersect"] = sum(ws.df[which(!wrs.inds1 & (ws.df$Within_Levee == 1 & ws.df[,buf.ws.col] == 0)),"Area_Ha"])
area.df[n,"below_flood_only"] = sum(ws.df[which(wrs.inds1 & (ws.df$Within_Levee == 0 & ws.df[,buf.ws.col] == 1)),"Area_Ha"])
area.df[n,"leveed_and_below_flood"] = sum(ws.df[which(wrs.inds1 & (ws.df$Within_Levee == 1 & ws.df[,buf.ws.col] == 1)),"Area_Ha"])
area.df[n,"non_intersect_and_below_flood"] = sum(ws.df[which(wrs.inds1 & (ws.df$Within_Levee == 0 & ws.df[,buf.ws.col] == 0)),"Area_Ha"])
area.df[n,"leveed_non_intersect_below_flood"] = sum(ws.df[which(wrs.inds1 & (ws.df$Within_Levee == 1 & ws.df[,buf.ws.col] == 0)),"Area_Ha"])
# calculate cumulative non-WOTUS wetland area for each wetland type
pond.df = ws.df[which(ws.df$WETLAND_TYPE == "Freshwater Pond"),]
emerg.df = ws.df[which(ws.df$WETLAND_TYPE == "Freshwater Emergent Wetland"),]
forest.df = ws.df[which(ws.df$WETLAND_TYPE == "Freshwater Forested/Shrub Wetland"),]
wrs.inds.p = !(pond.df$WATER_REGI %in% wrs1)
wrs.inds.e = !(emerg.df$WATER_REGI %in% wrs1)
wrs.inds.f = !(forest.df$WATER_REGI %in% wrs1)
area.df[n,"pond"] = sum(pond.df[which(wrs.inds.p | (pond.df$Within_Levee == 1 | pond.df[,buf.ws.col] == 0)),"Area_Ha"])
area.df[n,"emergent"] = sum(emerg.df[which(wrs.inds.e | (emerg.df$Within_Levee == 1 | emerg.df[,buf.ws.col] == 0)),"Area_Ha"])
area.df[n,"forest"] = sum(forest.df[which(wrs.inds.f | (forest.df$Within_Levee == 1 | forest.df[,buf.ws.col] == 0)),"Area_Ha"])
# increment counter
n = n + 1
}
}
}
}
# calculate statistics by dataset
area.stats.df = area.df %>%
group_by(dataset, water_cutoff) %>%
summarize(mean = mean(area),
min = min(area),
max = max(area))
# update water label
area.stats.df$water_label = rep(0, nrow(area.stats.df))
for (i in 1:n.w) { area.stats.df$water_label[which(area.stats.df$water_cutoff == water.regimes[i])] = water.reg.labels[i] }
# plot area by dataset and water cutoff
ggplot(area.stats.df, aes(x=mean,
y=factor(water_label, levels=water.reg.labels),
group=factor(dataset, levels=datasets),
color=factor(dataset, levels=datasets),
linetype=factor(dataset, levels=datasets))) +
geom_line(linewidth=0.8) +
geom_ribbon(data = area.stats.df,
aes(xmin=min, xmax=max,
group=factor(dataset, levels=datasets),
color=factor(dataset, levels=datasets),
linetype=factor(dataset, levels=datasets)),
alpha=0.1, linewidth=0.9) +
labs(y="Wetland Flood Frequency Cutoff",
x="Non-WOTUS Wetland Area (ha)",
color="Dataset",
linetype="Dataset",
group="Dataset") +
scale_x_continuous(limits=c(0,450000), labels=scales::comma)
path_to_soil_folder = "C:/Users/Chels/OneDrive - University of Illinois - Urbana/Ch1/Public-Repo/Soil_Analysis"
setwd(path_to_soil_folder)
library(ggplot2)
library(patchwork)
library(RColorBrewer)
################################################################################
### plot Bayesian model results for soil properties
# treatment names
trts = c("A","B","C","D","E","R")
trt.names = c("Balled-and-burlapped","Bareroot","Seedling","Acorn","Seedbank","Reference")
# read in HPDIs
df.int = read.csv("Posteriors/All_Soil_Posterior_Intervals_ChainCount5.csv")
# print results for tables
cbind(df.int[which(df.int$v == var.labels[6]),c("v","t")],
round(df.int[which(df.int$v == var.labels[6]),c("mean","X5","X95")],2))
path_to_soil_folder = "C:/Users/Chels/OneDrive - University of Illinois - Urbana/Ch1/Public-Repo/Soil_Analysis"
setwd(path_to_soil_folder)
library(ggplot2)
library(patchwork)
library(RColorBrewer)
################################################################################
### plot Bayesian model results for soil properties
# treatment names
trts = c("A","B","C","D","E","R")
trt.names = c("Balled-and-burlapped","Bareroot","Seedling","Acorn","Seedbank","Reference")
# variable labels
var.labels = c("SOM (%)","TOC (%)","TIC (%)","POM-C (%)","MAOM-C (%)","TC (%)","TN (%)","C:N Ratio",
"Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"Sand (%)","Silt (%)","Clay (%)","NO3 (ppm)","NH4 (ppm)","P (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)","K (meq)","Ca (meq)","Mg (meq)",
"CEC (meq/100 g)","pH","Floating POM",
">4.75 mm","2 - 4.75 mm","250 \u03bcm - 2 mm","53 - 250 \u03bcm",
"<53 \u03bcm","Mean-weight diameter (mm)")
# read in HPDIs
df.int = read.csv("Posteriors/All_Soil_Posterior_Intervals_ChainCount5.csv")
# print results for tables
cbind(df.int[which(df.int$v == var.labels[6]),c("v","t")],
round(df.int[which(df.int$v == var.labels[6]),c("mean","X5","X95")],2))
ggplot(df.int, aes(y=factor(t, levels=trt.names),
x=mean)) +
geom_errorbarh(aes(xmin=X5, xmax=X95), color="black") +
geom_errorbarh(aes(xmin=X25, xmax=X75), color="blue") +
geom_point() +
facet_wrap(.~v, scales="free_x",ncol=5)
# run PCA
PCA = prcomp(~ TIC+POC+MAOC+CN+MWD+CEC+Sand+Clay+pH+P+K+Ca+Mg+TN+NO3+NH4+BD+Moisture+Temp+HL+FWD+MB+PAB+HJB,
data=df, scale=T, center=T)
path_to_repo = "C:/Users/Chels/OneDrive - University of Illinois - Urbana/Ch1/Public-Repo"
setwd(path_to_repo)
library(ggplot2)
library(ggfortify)
library(patchwork)
library(ggrepel)
# treatment names
trts = c("A","B","C","D","E","R")
trt.names = c("Balled-and-burlapped","Bareroot","Seedling","Acorn","Seedbank","Reference")
## read in all soil data
soil.dat = read.csv("Soil_Analysis/Clean_Data/All_Soil_Data_2023.csv")
## read in biomass data
bm.dat = read.csv("Understory_Analysis/Clean_Data/Biomass_By_Quadrat_and_Year.csv")
bm.dat.2022 = bm.dat[which(bm.dat$year == 2022),-which(colnames(bm.dat) == "year")]
# soil data labels
ag.cols = c("fPOM","g475mm","g2mm","g250um","g53um","l53um","MWD")
meq.cols = c("k.meq","ca.meq","mg.meq","h.meq")
text.cols = c("Sand","Silt","Clay")
# combine biomass and soil dta
all.dat = left_join(soil.dat[,-which(colnames(soil.dat) %in% c(meq.cols,"volumetric.moisture","ton","pon"))], bm.dat.2022,
by=c("trt","trt.full","num","quad"))
# remove reference
df = all.dat[-which(all.dat$trt == "R"),]
# update column names
colnames(df)[6:40] = c("Temp","Moisture","BD","TN","TC","CN","TOC",
text.cols,"pH","P","K","Ca","Mg","SOM",
"NO3","NH4","CEC","POC",ag.cols,"TIC",
"MAOC","HB","HL","FWD",
"MB","PAB","HJB")
# run PCA
PCA = prcomp(~ TIC+POC+MAOC+CN+MWD+CEC+Sand+Clay+pH+P+K+Ca+Mg+TN+NO3+NH4+BD+Moisture+Temp+HL+FWD+MB+PAB+HJB,
data=df, scale=T, center=T)
#PCA loadings
PCAloadings <- data.frame(Variables = rownames(PCA$rotation), PCA$rotation)
# add PCA scores to the dataset
df[, c('PC1', 'PC2')] = PCA$x[, 1:2]
# save variable loadings in a separate dataset
rot = as.data.frame(PCA$rotation[, 1:2])
rot$var = rownames(PCA$rotation)
# rescale the loadings to fit nicely within the scatterplot of our data
mult = max(abs(df[, c('PC1', 'PC2')])) / max(abs(rot[, 1:2])) / 2
rot[, 1:2] = rot[, 1:2] * mult
# make plot
p1 = ggplot(data=rot,
aes(x=0, y=0, xend=PC1, yend=PC2, label=var)) +
geom_point(data=df, aes(x=PC1, y=PC2, color=trt.full, shape=num),
inherit.aes=FALSE, size=3) +
geom_segment(color='red', arrow=arrow(length=unit(0.03,"npc"))) +
geom_label_repel(aes(PC1 * 1.001, PC2 * 1.001)) +
theme_bw() + labs(color="Treatment", shape="Plot") +
theme(panel.grid = element_blank()) +
scale_y_continuous(limits=c(-4,4)) +
scale_x_continuous(limits=c(-4,4)) +
labs(x="PC1 (17.4%)",y="PC2 (13.1%)") +
theme(text = element_text(size=14))
p1
path_to_repo = "C:/Users/Chels/OneDrive - University of Illinois - Urbana/Ch1/Public-Repo"
setwd(path_to_repo)
library(ggplot2)
library(ggfortify)
library(patchwork)
library(ggrepel)
# treatment names
trts = c("A","B","C","D","E","R")
trt.names = c("Balled-and-burlapped","Bareroot","Seedling","Acorn","Seedbank","Reference")
## read in all soil data
soil.dat = read.csv("Soil_Analysis/Clean_Data/All_Soil_Data_2023.csv")
## read in biomass data
bm.dat = read.csv("Understory_Analysis/Clean_Data/Biomass_By_Quadrat_and_Year.csv")
bm.dat.2022 = bm.dat[which(bm.dat$year == 2022),-which(colnames(bm.dat) == "year")]
# soil data labels
ag.cols = c("fPOM","g475mm","g2mm","g250um","g53um","l53um","MWD")
meq.cols = c("k.meq","ca.meq","mg.meq","h.meq")
text.cols = c("Sand","Silt","Clay")
# combine biomass and soil dta
all.dat = left_join(soil.dat[,-which(colnames(soil.dat) %in% c(meq.cols,"volumetric.moisture","ton","pon"))], bm.dat.2022,
by=c("trt","trt.full","num","quad"))
# remove reference
df = all.dat[-which(all.dat$trt == "R"),]
# update column names
colnames(df)[6:40] = c("Temp","Moisture","BD","TN","TC","CN","TOC",
text.cols,"pH","P","K","Ca","Mg","SOM",
"NO3","NH4","CEC","POC",ag.cols,"TIC",
"MAOC","HB","HL","FWD",
"MB","PAB","HJB")
# run PCA
PCA = prcomp(~ TIC+POC+MAOC+CN+MWD+CEC+Sand+Clay+pH+P+K+Ca+Mg+TN+NO3+NH4+BD+Moisture+Temp+HL+FWD+MB+PAB+HJB,
data=df, scale=T, center=T)
# plot PCA with autoplot
df$trt.full = factor(df$trt.full, levels=trt.names)
df$num = factor(df$num)
PCAloadings <- data.frame(Variables = rownames(PCA$rotation), PCA$rotation)
# add PCA scores to the dataset
df[, c('PC1', 'PC2')] = PCA$x[, 1:2]
# save variable loadings in a separate dataset
rot = as.data.frame(PCA$rotation[, 1:2])
rot$var = rownames(PCA$rotation)
# rescale the loadings to fit nicely within the scatterplot of our data
mult = max(abs(df[, c('PC1', 'PC2')])) / max(abs(rot[, 1:2])) / 2
rot[, 1:2] = rot[, 1:2] * mult
# make plot
p1 = ggplot(data=rot,
aes(x=0, y=0, xend=PC1, yend=PC2, label=var)) +
geom_point(data=df, aes(x=PC1, y=PC2, color=trt.full, shape=num),
inherit.aes=FALSE, size=3) +
geom_segment(color='red', arrow=arrow(length=unit(0.03,"npc"))) +
geom_label_repel(aes(PC1 * 1.001, PC2 * 1.001)) +
theme_bw() + labs(color="Treatment", shape="Plot") +
theme(panel.grid = element_blank()) +
scale_y_continuous(limits=c(-4,4)) +
scale_x_continuous(limits=c(-4,4)) +
labs(x="PC1 (17.4%)",y="PC2 (13.1%)") +
theme(text = element_text(size=14))
p1
autoplot(PCA, x=1, y=2, data=df,
loadings=T, loadings.label=T, size=4, loadings.label.colour='black',
col="trt.full", shape="num", loadings.label.size=4,
loadings.label.vjust = -0.15, loadings.label.hjust = 0.1) +
labs(color="Treatment", shape="Plot")
# write plot
ggsave("Figures/Figure5_Soil_Vegetation_PCA.jpeg",
plot = p1, width = 20, height = 14, units="cm")
summary(PCA)
PCA$rotation[,1:5]
sort(PCA$rotation[,1]) # Silt/BD - SOM/CEC
sort(PCA$rotation[,2]) # Sand - Silt - Clay/P
sort(PCA$rotation[,3]) # Clay/sand - CEC/Silt
# Percentage of variance explained
eigenvalues <- PCA$sdev^2
plot(eigenvalues/sum(eigenvalues), type = "b",
xlab = "Principal Component",
ylab = "Percentage of Variance Explained", ylim=c(0,0.2))
round(eigenvalues/sum(eigenvalues)*100,2)
round(cumsum(eigenvalues/sum(eigenvalues)*100),2)
autoplot(PCA, x=2, y=3, data=df,
loadings=T, loadings.label=T, size=4, loadings.label.colour='black',
col="trt.full", shape="num", loadings.label.size=4,
loadings.label.vjust = -0.15, loadings.label.hjust = 0.1) +
labs(color="Treatment", shape="Plot")
autoplot(PCA, x=1, y=3, data=df,
loadings=T, loadings.label=T, size=4, loadings.label.colour='black',
col="trt.full", shape="num", loadings.label.size=4,
loadings.label.vjust = -0.15, loadings.label.hjust = 0.1) +
labs(color="Treatment", shape="Plot")
autoplot(PCA, x=1, y=2, data=df,
loadings=T, loadings.label=T, size=4, loadings.label.colour='black',
col="trt.full", shape="num", loadings.label.size=4,
loadings.label.vjust = -0.15, loadings.label.hjust = 0.1) +
labs(color="Treatment", shape="Plot")
plot(eigenvalues/sum(eigenvalues), type = "b",
xlab = "Principal Component",
ylab = "Percentage of Variance Explained", ylim=c(0,0.2))
autoplot(PCA, x=2, y=3, data=df,
loadings=T, loadings.label=T, size=4, loadings.label.colour='black',
col="trt.full", shape="num", loadings.label.size=4,
loadings.label.vjust = -0.15, loadings.label.hjust = 0.1) +
labs(color="Treatment", shape="Plot")
ggplot(df.int, aes(y=factor(t, levels=trt.names),
x=mean)) +
geom_errorbarh(aes(xmin=X5, xmax=X95), color="black") +
geom_errorbarh(aes(xmin=X25, xmax=X75), color="blue") +
geom_point() +
facet_wrap(.~v, scales="free_x",ncol=5)
# add PCA scores to the dataset
df[, c('PC1','PC2','PC3')] = PCA$x[, 1:3]
PCAloadings <- data.frame(Variables = rownames(PCA$rotation), PCA$rotation)
# add PCA scores to the dataset
df[, c('PC1','PC2','PC3')] = PCA$x[, 1:3]
# save variable loadings in a separate dataset
rot = as.data.frame(PCA$rotation[, 1:3])
rot$var = rownames(PCA$rotation)
# rescale the loadings to fit nicely within the scatterplot of our data
mult = max(abs(df[, c('PC1', 'PC2')])) / max(abs(rot[, 1:3])) / 2
rot[, 1:3] = rot[, 1:3] * mult
# make plot
p1 = ggplot(data=rot,
aes(x=0, y=0, xend=PC1, yend=PC2, label=var)) +
geom_point(data=df, aes(x=PC1, y=PC2, color=trt.full, shape=num),
inherit.aes=FALSE, size=3) +
geom_segment(color='red', arrow=arrow(length=unit(0.03,"npc"))) +
geom_label_repel(aes(PC1 * 1.001, PC2 * 1.001)) +
theme_bw() + labs(color="Treatment", shape="Plot") +
theme(panel.grid = element_blank()) +
scale_y_continuous(limits=c(-4,4)) +
scale_x_continuous(limits=c(-4,4)) +
labs(x="PC1 (16.8%)",y="PC2 (12.6%)") +
theme(text = element_text(size=14))
p1
PCAloadings <- data.frame(Variables = rownames(PCA$rotation), PCA$rotation)
# add PCA scores to the dataset
df[, c('PC1','PC2','PC3')] = PCA$x[, 1:3]
# save variable loadings in a separate dataset
rot = as.data.frame(PCA$rotation[, 1:3])
rot$var = rownames(PCA$rotation)
# rescale the loadings to fit nicely within the scatterplot of our data
mult = max(abs(df[, c('PC1','PC2','PC3')])) / max(abs(rot[, 1:3])) / 2
rot[, 1:3] = rot[, 1:3] * mult
# make plot
p1 = ggplot(data=rot,
aes(x=0, y=0, xend=PC1, yend=PC2, label=var)) +
geom_point(data=df, aes(x=PC1, y=PC2, color=trt.full, shape=num),
inherit.aes=FALSE, size=3) +
geom_segment(color='red', arrow=arrow(length=unit(0.03,"npc"))) +
geom_label_repel(aes(PC1 * 1.001, PC2 * 1.001)) +
theme_bw() + labs(color="Treatment", shape="Plot") +
theme(panel.grid = element_blank()) +
scale_y_continuous(limits=c(-4,4)) +
scale_x_continuous(limits=c(-4,4)) +
labs(x="PC1 (16.8%)",y="PC2 (12.6%)") +
theme(text = element_text(size=14))
p1
autoplot(PCA, x=1, y=3, data=df,
loadings=T, loadings.label=T, size=4, loadings.label.colour='black',
col="trt.full", shape="num", loadings.label.size=4,
loadings.label.vjust = -0.15, loadings.label.hjust = 0.1) +
labs(color="Treatment", shape="Plot")
p1 = ggplot(data=rot,
aes(x=0, y=0, xend=PC1, yend=PC2, label=var)) +
geom_point(data=df, aes(x=PC1, y=PC2, color=trt.full, shape=num),
inherit.aes=FALSE, size=3) +
geom_segment(color='red', arrow=arrow(length=unit(0.03,"npc"))) +
geom_label_repel(aes(PC1 * 1.001, PC2 * 1.001)) +
theme_bw() + labs(color="Treatment", shape="Plot") +
theme(panel.grid = element_blank()) +
scale_y_continuous(limits=c(-4,4)) +
scale_x_continuous(limits=c(-4,4)) +
labs(x="PC1 (16.8%)",y="PC2 (12.6%)") +
theme(text = element_text(size=14))
p2 = ggplot(data=rot,
aes(x=0, y=0, xend=PC1, yend=PC3, label=var)) +
geom_point(data=df, aes(x=PC1, y=PC3, color=trt.full, shape=num),
inherit.aes=FALSE, size=3) +
geom_segment(color='red', arrow=arrow(length=unit(0.03,"npc"))) +
geom_label_repel(aes(PC1 * 1.001, PC3 * 1.001)) +
theme_bw() + labs(color="Treatment", shape="Plot") +
theme(panel.grid = element_blank()) +
scale_y_continuous(limits=c(-4,4)) +
scale_x_continuous(limits=c(-4,4)) +
labs(x="PC1 (16.8%)",y="PC3 (10.7%)") +
theme(text = element_text(size=14))
p1 + p2
p1 = ggplot(data=rot,
aes(x=0, y=0, xend=PC1, yend=PC2, label=var)) +
geom_point(data=df, aes(x=PC1, y=PC2, color=trt.full, shape=num),
inherit.aes=FALSE, size=3) +
geom_segment(color='red', arrow=arrow(length=unit(0.03,"npc"))) +
geom_label_repel(aes(PC1 * 1.001, PC2 * 1.001)) +
theme_bw() + labs(color="Treatment", shape="Plot") +
scale_y_continuous(limits=c(-4,4)) +
scale_x_continuous(limits=c(-4,4)) +
labs(x="PC1 (16.8%)",y="PC2 (12.6%)") +
theme(text = element_text(size=14),
panel.grid = element_blank(),legend.position='none')
p2 = ggplot(data=rot,
aes(x=0, y=0, xend=PC1, yend=PC3, label=var)) +
geom_point(data=df, aes(x=PC1, y=PC3, color=trt.full, shape=num),
inherit.aes=FALSE, size=3) +
geom_segment(color='red', arrow=arrow(length=unit(0.03,"npc"))) +
geom_label_repel(aes(PC1 * 1.001, PC3 * 1.001)) +
theme_bw() + labs(color="Treatment", shape="Plot") +
scale_y_continuous(limits=c(-4,4)) +
scale_x_continuous(limits=c(-4,4)) +
labs(x="PC1 (16.8%)",y="PC3 (10.7%)") +
theme(text = element_text(size=14),
panel.grid = element_blank())
p1 + p2
autoplot(PCA, x=2, y=3, data=df,
loadings=T, loadings.label=T, size=4, loadings.label.colour='black',
col="trt.full", shape="num", loadings.label.size=4,
loadings.label.vjust = -0.15, loadings.label.hjust = 0.1) +
labs(color="Treatment", shape="Plot")
autoplot(PCA, x=1, y=3, data=df,
loadings=T, loadings.label=T, size=4, loadings.label.colour='black',
col="trt.full", shape="num", loadings.label.size=4,
loadings.label.vjust = -0.15, loadings.label.hjust = 0.1) +
labs(color="Treatment", shape="Plot")
autoplot(PCA, x=2, y=3, data=df,
loadings=T, loadings.label=T, size=4, loadings.label.colour='black',
col="trt.full", shape="num", loadings.label.size=4,
loadings.label.vjust = -0.15, loadings.label.hjust = 0.1) +
labs(color="Treatment", shape="Plot")
p3 = p1 + p2
p1 = ggplot(data=rot,
aes(x=0, y=0, xend=PC1, yend=PC2, label=var)) +
geom_point(data=df, aes(x=PC1, y=PC2, color=trt.full, shape=num),
inherit.aes=FALSE, size=3) +
geom_segment(color='red', arrow=arrow(length=unit(0.03,"npc"))) +
geom_label_repel(aes(PC1 * 1.001, PC2 * 1.001)) +
theme_bw() + labs(color="Treatment", shape="Plot") +
scale_y_continuous(limits=c(-4,4)) +
scale_x_continuous(limits=c(-4,4)) +
labs(x="PC1 (16.8%)",y="PC2 (12.6%)") +
theme(text = element_text(size=14),
panel.grid = element_blank(),legend.position='none')
p2 = ggplot(data=rot,
aes(x=0, y=0, xend=PC1, yend=PC3, label=var)) +
geom_point(data=df, aes(x=PC1, y=PC3, color=trt.full, shape=num),
inherit.aes=FALSE, size=3) +
geom_segment(color='red', arrow=arrow(length=unit(0.03,"npc"))) +
geom_label_repel(aes(PC1 * 1.001, PC3 * 1.001)) +
theme_bw() + labs(color="Treatment", shape="Plot") +
scale_y_continuous(limits=c(-4,4)) +
scale_x_continuous(limits=c(-4,4)) +
labs(x="PC1 (16.8%)",y="PC3 (10.7%)") +
theme(text = element_text(size=14),
panel.grid = element_blank())
p3 = p1 + p2
# write plot
ggsave("Figures/Figure5_Soil_Vegetation_PCA.jpeg",
plot = p3, width = 30, height = 14, units="cm")
autoplot(PCA, x=1, y=4, data=df,
loadings=T, loadings.label=T, size=4, loadings.label.colour='black',
col="trt.full", shape="num", loadings.label.size=4,
loadings.label.vjust = -0.15, loadings.label.hjust = 0.1) +
labs(color="Treatment", shape="Plot")
autoplot(PCA, x=1, y=3, data=df,
loadings=T, loadings.label=T, size=4, loadings.label.colour='black',
col="trt.full", shape="num", loadings.label.size=4,
loadings.label.vjust = -0.15, loadings.label.hjust = 0.1) +
labs(color="Treatment", shape="Plot")
autoplot(PCA, x=1, y=4, data=df,
loadings=T, loadings.label=T, size=4, loadings.label.colour='black',
col="trt.full", shape="num", loadings.label.size=4,
loadings.label.vjust = -0.15, loadings.label.hjust = 0.1) +
labs(color="Treatment", shape="Plot")
# write plot
ggsave("Figures/Figure5_Soil_Vegetation_PCA.jpeg",
plot = p3, width = 32, height = 14, units="cm")
# write plot
ggsave("Figures/Figure5_Soil_Vegetation_PCA.jpeg",
plot = p3, width = 34, height = 14, units="cm")
