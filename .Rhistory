nwi.pred.df[1:500,i] = inv_logit(nwi.samples$a + nwi.samples$b*areas[i])
du.pred.df[1:500,i] = inv_logit(du.samples$a + du.samples$b*areas[i])
}
nwi.pred.sum = data.frame("dataset" = "Original NWI",
"area" = nwi.areas,
"mean" = apply(nwi.pred.df, 2, FUN=mean),
"lower" = apply(nwi.pred.df, 2, function(x) HPDI(x, prob=0.95))[1,],
"upper" = apply(nwi.pred.df, 2, function(x) HPDI(x, prob=0.95))[2,])
du.pred.sum = data.frame("dataset" = "Ducks Unlimited",
"area" = du.areas,
"mean" = apply(du.pred.df, 2, FUN=mean),
"lower" = apply(du.pred.df, 2, function(x) HPDI(x, prob=0.95))[1,],
"upper" = apply(du.pred.df, 2, function(x) HPDI(x, prob=0.95))[2,])
pred.sum = rbind(nwi.pred.sum, du.pred.sum)
ggplot(pred.sum, aes(x=area,y=mean,fill=dataset)) +
geom_line() +
geom_ribbon(aes(x=area,ymin=lower,ymax=upper))
ggplot(pred.sum, aes(x=log(area),y=mean,fill=dataset)) +
geom_line() +
geom_ribbon(aes(x=area,ymin=lower,ymax=upper))
ggplot(pred.sum, aes(x=log(area),y=mean,fill=dataset)) +
geom_line() +
geom_ribbon(aes(x=log(area),ymin=lower,ymax=upper))
ggplot(pred.sum, aes(x=log(area),y=mean,fill=dataset)) +
geom_line() +
geom_ribbon(aes(x=log(area),ymin=lower,ymax=upper)) +
scale_fill_manual(values=c("Original NWI"="forestgreen",
"Ducks Unlimited"="steelblue4"))
ggplot(pred.sum, aes(x=log(area),y=mean,fill=dataset)) +
geom_line() +
geom_ribbon(aes(x=log(area),ymin=lower,ymax=upper),alpha=0.1) +
scale_fill_manual(values=c("Original NWI"="forestgreen",
"Ducks Unlimited"="steelblue4"))
ggplot(pred.sum, aes(x=log(area),y=mean,fill=dataset)) +
geom_line() +
geom_ribbon(aes(x=log(area),ymin=lower,ymax=upper),alpha=0.5) +
scale_fill_manual(values=c("Original NWI"="forestgreen",
"Ducks Unlimited"="steelblue4"))
n = 1000
nwi.areas = seq(min(nwi.df$Shape_Area)/10^4, max(nwi.df$Shape_Area)/10^4, length.out=n)
du.areas = seq(min(du.df$Shape_Area)/10^4, max(du.df$Shape_Area)/10^4, length.out=n)
nwi.pred.df = data.frame(matrix(nrow=500,ncol=n))
du.pred.df = data.frame(matrix(nrow=500,ncol=n))
for (i in 1:n) {
nwi.pred.df[1:500,i] = inv_logit(nwi.samples$a + nwi.samples$b*areas[i])
du.pred.df[1:500,i] = inv_logit(du.samples$a + du.samples$b*areas[i])
}
nwi.pred.sum = data.frame("dataset" = "Original NWI",
"area" = nwi.areas,
"mean" = apply(nwi.pred.df, 2, FUN=mean),
"lower" = apply(nwi.pred.df, 2, function(x) HPDI(x, prob=0.95))[1,],
"upper" = apply(nwi.pred.df, 2, function(x) HPDI(x, prob=0.95))[2,])
n = 1000
nwi.areas = seq(min(nwi.df$Shape_Area)/10^4, max(nwi.df$Shape_Area)/10^4, length.out=n)
du.areas = seq(min(du.df$Shape_Area)/10^4, max(du.df$Shape_Area)/10^4, length.out=n)
nwi.pred.df = data.frame(matrix(nrow=500,ncol=n))
du.pred.df = data.frame(matrix(nrow=500,ncol=n))
for (i in 1:n) {
nwi.pred.df[1:500,i] = inv_logit(nwi.samples$a + nwi.samples$b*areas[i])
du.pred.df[1:500,i] = inv_logit(du.samples$a + du.samples$b*areas[i])
}
nwi.pred.sum = data.frame("dataset" = "Original NWI",
"area" = nwi.areas,
"mean" = apply(nwi.pred.df, 2, FUN=mean),
"lower" = apply(nwi.pred.df, 2, function(x) HPDI(x, prob=0.95))[1,],
"upper" = apply(nwi.pred.df, 2, function(x) HPDI(x, prob=0.95))[2,])
n = 200
nwi.areas = seq(min(nwi.df$Shape_Area)/10^4, max(nwi.df$Shape_Area)/10^4, length.out=n)
du.areas = seq(min(du.df$Shape_Area)/10^4, max(du.df$Shape_Area)/10^4, length.out=n)
nwi.pred.df = data.frame(matrix(nrow=500,ncol=n))
du.pred.df = data.frame(matrix(nrow=500,ncol=n))
for (i in 1:n) {
nwi.pred.df[1:500,i] = inv_logit(nwi.samples$a + nwi.samples$b*areas[i])
du.pred.df[1:500,i] = inv_logit(du.samples$a + du.samples$b*areas[i])
}
nwi.pred.sum = data.frame("dataset" = "Original NWI",
"area" = nwi.areas,
"mean" = apply(nwi.pred.df, 2, FUN=mean),
"lower" = apply(nwi.pred.df, 2, function(x) HPDI(x, prob=0.95))[1,],
"upper" = apply(nwi.pred.df, 2, function(x) HPDI(x, prob=0.95))[2,])
apply(nwi.pred.df, 2, FUN=mean)
nwi.samples = extract.samples(m.nwi)
du.samples = extract.samples(m.du)
n = 1000
nwi.areas = seq(min(nwi.df$Shape_Area)/10^4, max(nwi.df$Shape_Area)/10^4, length.out=n)
du.areas = seq(min(du.df$Shape_Area)/10^4, max(du.df$Shape_Area)/10^4, length.out=n)
nwi.pred.df = data.frame(matrix(nrow=500,ncol=n))
du.pred.df = data.frame(matrix(nrow=500,ncol=n))
for (i in 1:n) {
nwi.pred.df[1:500,i] = inv_logit(nwi.samples$a + nwi.samples$b*nwi.areas[i])
du.pred.df[1:500,i] = inv_logit(du.samples$a + du.samples$b*du.areas[i])
}
nwi.pred.sum = data.frame("dataset" = "Original NWI",
"area" = nwi.areas,
"mean" = apply(nwi.pred.df, 2, FUN=mean),
"lower" = apply(nwi.pred.df, 2, function(x) HPDI(x, prob=0.95))[1,],
"upper" = apply(nwi.pred.df, 2, function(x) HPDI(x, prob=0.95))[2,])
du.pred.sum = data.frame("dataset" = "Ducks Unlimited",
"area" = du.areas,
"mean" = apply(du.pred.df, 2, FUN=mean),
"lower" = apply(du.pred.df, 2, function(x) HPDI(x, prob=0.95))[1,],
"upper" = apply(du.pred.df, 2, function(x) HPDI(x, prob=0.95))[2,])
pred.sum = rbind(nwi.pred.sum, du.pred.sum)
ggplot(pred.sum, aes(x=log(area),y=mean,fill=dataset)) +
geom_line() +
geom_ribbon(aes(x=log(area),ymin=lower,ymax=upper),alpha=0.5) +
scale_fill_manual(values=c("Original NWI"="forestgreen",
"Ducks Unlimited"="steelblue4"))
scale_fill_manual(values=c("Original NWI"="forestgreen",
"Ducks Unlimited"="steelblue4"))
ggplot(pred.sum, aes(x=log(area),y=mean,fill=dataset)) +
geom_line() +
geom_ribbon(aes(x=log(area),ymin=lower,ymax=upper),alpha=0.5) +
labs(x="Log(Polygon area [Ha])",y="Probability of commission error",
fill="Dataset") +
scale_fill_manual(values=c("Original NWI"="forestgreen",
"Ducks Unlimited"="steelblue4"))
min(nwi.df$Shape_Area)/10^4
min(du.df$Shape_Area)/10^4
max(nwi.df$Shape_Area)/10^4
max(du.df$Shape_Area)/10^4
n = 1000
nwi.areas = seq(0.01, 1200, length.out=n)
du.areas = seq(0.01, 1200, length.out=n)
nwi.pred.df = data.frame(matrix(nrow=500,ncol=n))
du.pred.df = data.frame(matrix(nrow=500,ncol=n))
for (i in 1:n) {
nwi.pred.df[1:500,i] = inv_logit(nwi.samples$a + nwi.samples$b*nwi.areas[i])
du.pred.df[1:500,i] = inv_logit(du.samples$a + du.samples$b*du.areas[i])
}
nwi.pred.sum = data.frame("dataset" = "Original NWI",
"area" = nwi.areas,
"mean" = apply(nwi.pred.df, 2, FUN=mean),
"lower" = apply(nwi.pred.df, 2, function(x) HPDI(x, prob=0.95))[1,],
"upper" = apply(nwi.pred.df, 2, function(x) HPDI(x, prob=0.95))[2,])
du.pred.sum = data.frame("dataset" = "Ducks Unlimited",
"area" = du.areas,
"mean" = apply(du.pred.df, 2, FUN=mean),
"lower" = apply(du.pred.df, 2, function(x) HPDI(x, prob=0.95))[1,],
"upper" = apply(du.pred.df, 2, function(x) HPDI(x, prob=0.95))[2,])
pred.sum = rbind(nwi.pred.sum, du.pred.sum)
ggplot(pred.sum, aes(x=log(area),y=mean,fill=dataset)) +
geom_line() +
geom_ribbon(aes(x=log(area),ymin=lower,ymax=upper),alpha=0.5) +
labs(x="Log(Polygon area [Ha])",y="Probability of commission error",
fill="Dataset") +
scale_fill_manual(values=c("Original NWI"="forestgreen",
"Ducks Unlimited"="steelblue4"))
ggplot(commission.county.df,
aes(y=Proj_County, x=commission_rate)) +
geom_bar(stat="identity") +
labs(x = "Commission rate", y="County or County Group")
ggplot(commission.type.df,
aes(y=NWI_Code_Simple, x=commission_rate)) +
geom_bar(stat="identity") +
labs(x = "Commission rate", y="NWI Cowardin Class")
setwd("C:/Users/Chels/OneDrive - University of Illinois - Urbana/Illinois Wetlands Risk Assessment/Databases/INHS Database Data")
library(readxl)
library(tidyr)
# read in dataframes
nwi.df = read.csv("INHS_WS_Step4_NonDeep_Intersect.csv")
du.df = read.csv("INHS_DU_Step4_NonDeep_Intersect.csv")
# create wetland yes/no field
nwi.df$wetland.yn = (nwi.df$WetLand == "Yes")
du.df$wetland.yn = (du.df$WetLand == "Yes")
nwi.df$ones = rep(1, nrow(nwi.df))
du.df$ones = rep(1, nrow(du.df))
# estimate commission rate by wetland type
nwi.type.stats = nwi.df %>%
group_by(WETLAND_TY) %>%
summarize(correct_rate = sum(wetland.yn)/sum(ones),
commission_rate = sum(1-wetland.yn)/sum(ones))
du.type.stats = du.df %>%
group_by(WETLAND_TY) %>%
summarize(correct_rate = sum(wetland.yn)/sum(ones),
commission_rate = sum(1-wetland.yn)/sum(ones))
nwi.type.stats$dataset = "Original NWI"
du.type.stats$dataset = "Ducks Unlimited"
all.type.stats = rbind(nwi.type.stats,du.type.stats)
# plot commission rate as a function of class name and dataset
ggplot(all.type.stats, aes(x=commission_rate,
y=WETLAND_TY,
fill=dataset)) +
geom_bar(stat="identity",position="dodge") +
scale_fill_manual(values=c("Original NWI"="forestgreen",
"Ducks Unlimited"="steelblue4"))
all.type.stats = all.type.stats[-which(all.type.stats$WETLAND_TY == "Lake"),]
ggplot(all.type.stats, aes(x=commission_rate,
y=WETLAND_TY,
fill=dataset)) +
geom_bar(stat="identity",position="dodge") +
scale_fill_manual(values=c("Original NWI"="forestgreen",
"Ducks Unlimited"="steelblue4"))
ggplot(all.type.stats, aes(x=commission_rate,
y=WETLAND_TY,
fill=dataset)) +
geom_bar(stat="identity",position="dodge") +
labs(y="",x="Commission error rate") +
scale_fill_manual(values=c("Original NWI"="forestgreen",
"Ducks Unlimited"="steelblue4"))
ggplot(all.type.stats, aes(x=commission_rate,
y=WETLAND_TY,
fill=dataset)) +
geom_bar(stat="identity",position="dodge",
fill="Dataset") +
labs(y="",x="Commission error rate") +
scale_fill_manual(values=c("Original NWI"="forestgreen",
"Ducks Unlimited"="steelblue4"))
ggplot(all.type.stats, aes(x=commission_rate,
y=WETLAND_TY,
fill=dataset)) +
geom_bar(stat="identity",position="dodge",
fill="Dataset") +
labs(y="",x="Commission error rate") +
scale_fill_manual(values=c("Original NWI"="forestgreen",
"Ducks Unlimited"="steelblue4"))
# read in dataframes
nwi.df = read.csv("INHS_WS_Step4_NonDeep_Intersect.csv")
du.df = read.csv("INHS_DU_Step4_NonDeep_Intersect.csv")
# create wetland yes/no field
nwi.df$wetland.yn = (nwi.df$WetLand == "Yes")
du.df$wetland.yn = (du.df$WetLand == "Yes")
nwi.df$ones = rep(1, nrow(nwi.df))
du.df$ones = rep(1, nrow(du.df))
# estimate commission rate by wetland type
nwi.type.stats = nwi.df %>%
group_by(WETLAND_TY) %>%
summarize(correct_rate = sum(wetland.yn)/sum(ones),
commission_rate = sum(1-wetland.yn)/sum(ones))
du.type.stats = du.df %>%
group_by(WETLAND_TY) %>%
summarize(correct_rate = sum(wetland.yn)/sum(ones),
commission_rate = sum(1-wetland.yn)/sum(ones))
nwi.type.stats$dataset = "Original NWI"
du.type.stats$dataset = "Ducks Unlimited"
all.type.stats = rbind(nwi.type.stats,du.type.stats)
# plot commission rate as a function of class name and dataset
all.type.stats = all.type.stats[-which(all.type.stats$WETLAND_TY == "Lake"),]
ggplot(all.type.stats, aes(x=commission_rate,
y=WETLAND_TY,
fill=dataset)) +
geom_bar(stat="identity",position="dodge",
fill="Dataset") +
labs(y="",x="Commission error rate") +
scale_fill_manual(values=c("Original NWI"="forestgreen",
"Ducks Unlimited"="steelblue4"))
ggplot(all.type.stats, aes(x=commission_rate,
y=WETLAND_TY,
fill=dataset)) +
geom_bar(stat="identity",position="dodge") +
labs(y="",x="Commission error rate",fill="Dataset") +
scale_fill_manual(values=c("Original NWI"="forestgreen",
"Ducks Unlimited"="steelblue4"))
nwi.class.stats = nwi.df %>%
group_by(CLASS_NAME) %>%
summarize(correct_rate = sum(wetland.yn)/sum(ones),
commission_rate = sum(1-wetland.yn)/sum(ones))
du.class.stats = du.df %>%
group_by(CLASS_NAME) %>%
summarize(correct_rate = sum(wetland.yn)/sum(ones),
commission_rate = sum(1-wetland.yn)/sum(ones))
nwi.class.stats$dataset = "Original NWI"
du.class.stats$dataset = "Ducks Unlimited"
all.class.stats = rbind(nwi.class.stats,du.class.stats)
# plot commission rate as a function of class name and dataset
ggplot(all.class.stats, aes(x=commission_rate,
y=CLASS_NAME,
fill=dataset)) +
geom_bar(stat="identity",position="dodge") +
scale_fill_manual(values=c("Original NWI"="forestgreen",
"Ducks Unlimited"="steelblue4"))
View(all.class.stats)
scale_fill_manual(values=c("Original NWI"="forestgreen",
"Ducks Unlimited"="steelblue4"))
# plot commission rate as a function of class name and dataset
ggplot(all.class.stats, aes(x=commission_rate,
y=CLASS_NAME,
fill=dataset)) +
geom_bar(stat="identity",position="dodge") +
labs(y="Class name",x="Commission error rate",fill="Dataset") +
scale_fill_manual(values=c("Original NWI"="forestgreen",
"Ducks Unlimited"="steelblue4"))
nwi.wr.stats = nwi.df %>%
group_by(WATER_REGI) %>%
summarize(correct_rate = sum(wetland.yn)/sum(ones),
commission_rate = sum(1-wetland.yn)/sum(ones))
du.wr.stats = du.df %>%
group_by(WATER_REGI) %>%
summarize(correct_rate = sum(wetland.yn)/sum(ones),
commission_rate = sum(1-wetland.yn)/sum(ones))
nwi.wr.stats$dataset = "Original NWI"
du.wr.stats$dataset = "Ducks Unlimited"
all.wr.stats = rbind(nwi.wr.stats,du.wr.stats)
# plot commission rate as a function of class name and dataset
ggplot(all.wr.stats, aes(x=commission_rate,
y=WATER_REGI,
fill=dataset)) +
geom_bar(stat="identity",position="dodge") +
labs(y="Water regime",x="Commission error rate",fill="Dataset") +
scale_fill_manual(values=c("Original NWI"="forestgreen",
"Ducks Unlimited"="steelblue4"))
sort(unique(nwi.df$FIRST_MODI))
path_to_soil_folder = "C:/Users/Chels/OneDrive - University of Illinois - Urbana/Ch1/Public-Repo/Soil_Analysis"
setwd(path_to_soil_folder)
library(ggplot2)
library(patchwork)
library(RColorBrewer)
################################################################################
### plot Bayesian model results for soil properties
# treatment names
trts = c("A","B","C","D","E","R")
trt.names = c("Balled-and-burlapped","Bareroot","Seedling","Acorn","Seedbank","Reference")
# variable labels
var.labels = c("SOM (%)","TOC (%)","TIC (%)","POM-C (%)","MAOM-C (%)","TC (%)","TN (%)","C:N Ratio",
"Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"Sand (%)","Silt (%)","Clay (%)","NO3 (ppm)","NH4 (ppm)","P (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)","K (meq)","Ca (meq)","Mg (meq)",
"CEC (meq/100 g)","pH","Floating POM",
">4.75 mm","2 - 4.75 mm","250 \u03bcm - 2 mm","53 - 250 \u03bcm",
"<53 \u03bcm","Mean-weight diameter (mm)")
# read in HPDIs
df.int = read.csv("Posteriors/All_Soil_Posterior_Intervals_ChainCount5.csv")
# print results for tables
cbind(df.int[which(df.int$v == var.labels[6]),c("v","t")],
round(df.int[which(df.int$v == var.labels[6]),c("mean","X5","X95")],2))
ggplot(df.int, aes(y=factor(t, levels=trt.names),
x=mean)) +
geom_errorbarh(aes(xmin=X5, xmax=X95), color="black") +
geom_errorbarh(aes(xmin=X25, xmax=X75), color="blue") +
geom_point() +
facet_wrap(.~v, scales="free_x",ncol=5)
path_to_soil_folder = "C:/Users/Chels/OneDrive - University of Illinois - Urbana/Ch1/Public-Repo/Soil_Analysis"
setwd(path_to_soil_folder)
#path_to_soil_folder = "C:/Users/Chels/OneDrive - University of Illinois - Urbana/Ch1/Public-Repo/Soil_Analysis"
path_to_soil_folder = "C:/Users/cmptrsn2/OneDrive - University of Illinois - Urbana/Ch1/Public-Repo/Soil_Analysis"
setwd(path_to_soil_folder)
library(ggplot2)
library(patchwork)
library(RColorBrewer)
################################################################################
### plot Bayesian model results for soil properties
# treatment names
trts = c("A","B","C","D","E","R")
trt.names = c("Balled-and-burlapped","Bareroot","Seedling","Acorn","Seedbank","Reference")
# variable labels
var.labels = c("SOM (%)","TOC (%)","TIC (%)","POM-C (%)","MAOM-C (%)","TC (%)","TN (%)","C:N Ratio",
"Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"Sand (%)","Silt (%)","Clay (%)","NO3 (ppm)","NH4 (ppm)","P (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)","K (meq)","Ca (meq)","Mg (meq)",
"CEC (meq/100 g)","pH","Floating POM",
">4.75 mm","2 - 4.75 mm","250 \u03bcm - 2 mm","53 - 250 \u03bcm",
"<53 \u03bcm","Mean-weight diameter (mm)")
# read in HPDIs
df.int = read.csv("Posteriors/All_Soil_Posterior_Intervals_ChainCount5.csv")
# print results for tables
cbind(df.int[which(df.int$v == var.labels[6]),c("v","t")],
round(df.int[which(df.int$v == var.labels[6]),c("mean","X5","X95")],2))
ggplot(df.int, aes(y=factor(t, levels=trt.names),
x=mean)) +
geom_errorbarh(aes(xmin=X5, xmax=X95), color="black") +
geom_errorbarh(aes(xmin=X25, xmax=X75), color="blue") +
geom_point() +
facet_wrap(.~v, scales="free_x",ncol=5)
path_to_repo = "C:/Users/Chels/OneDrive - University of Illinois - Urbana/Ch1/Public-Repo"
setwd(path_to_repo)
path_to_repo = "C:/Users/cmptrsn2/OneDrive - University of Illinois - Urbana/Ch1/Public-Repo"
setwd(path_to_repo)
library(ggplot2)
library(ggfortify)
library(patchwork)
library(ggrepel)
# treatment names
trts = c("A","B","C","D","E","R")
trt.names = c("Balled-and-burlapped","Bareroot","Seedling","Acorn","Seedbank","Reference")
## read in all soil data
soil.dat = read.csv("Soil_Analysis/Clean_Data/All_Soil_Data_2023.csv")
## read in biomass data
bm.dat = read.csv("Understory_Analysis/Clean_Data/Biomass_By_Quadrat_and_Year.csv")
bm.dat.2022 = bm.dat[which(bm.dat$year == 2022),-which(colnames(bm.dat) == "year")]
# soil data labels
ag.cols = c("fPOM","g475mm","g2mm","g250um","g53um","l53um","MWD")
meq.cols = c("k.meq","ca.meq","mg.meq","h.meq")
text.cols = c("Sand","Silt","Clay")
# combine biomass and soil dta
all.dat = left_join(soil.dat[,-which(colnames(soil.dat) %in% c(meq.cols,"volumetric.moisture","ton","pon"))], bm.dat.2022,
by=c("trt","trt.full","num","quad"))
library(tidyr)
# treatment names
trts = c("A","B","C","D","E","R")
trt.names = c("Balled-and-burlapped","Bareroot","Seedling","Acorn","Seedbank","Reference")
## read in all soil data
soil.dat = read.csv("Soil_Analysis/Clean_Data/All_Soil_Data_2023.csv")
## read in biomass data
bm.dat = read.csv("Understory_Analysis/Clean_Data/Biomass_By_Quadrat_and_Year.csv")
bm.dat.2022 = bm.dat[which(bm.dat$year == 2022),-which(colnames(bm.dat) == "year")]
# soil data labels
ag.cols = c("fPOM","g475mm","g2mm","g250um","g53um","l53um","MWD")
meq.cols = c("k.meq","ca.meq","mg.meq","h.meq")
text.cols = c("Sand","Silt","Clay")
# combine biomass and soil dta
all.dat = left_join(soil.dat[,-which(colnames(soil.dat) %in% c(meq.cols,"volumetric.moisture","ton","pon"))], bm.dat.2022,
by=c("trt","trt.full","num","quad"))
library(dplyr)
trts = c("A","B","C","D","E","R")
trt.names = c("Balled-and-burlapped","Bareroot","Seedling","Acorn","Seedbank","Reference")
## read in all soil data
soil.dat = read.csv("Soil_Analysis/Clean_Data/All_Soil_Data_2023.csv")
## read in biomass data
bm.dat = read.csv("Understory_Analysis/Clean_Data/Biomass_By_Quadrat_and_Year.csv")
bm.dat.2022 = bm.dat[which(bm.dat$year == 2022),-which(colnames(bm.dat) == "year")]
# soil data labels
ag.cols = c("fPOM","g475mm","g2mm","g250um","g53um","l53um","MWD")
meq.cols = c("k.meq","ca.meq","mg.meq","h.meq")
text.cols = c("Sand","Silt","Clay")
# combine biomass and soil dta
all.dat = left_join(soil.dat[,-which(colnames(soil.dat) %in% c(meq.cols,"volumetric.moisture","ton","pon"))], bm.dat.2022,
by=c("trt","trt.full","num","quad"))
# remove reference
df = all.dat[-which(all.dat$trt == "R"),]
# update column names
colnames(df)[6:40] = c("Temp","Moisture","BD","TN","TC","CN","TOC",
text.cols,"pH","P","K","Ca","Mg","SOM",
"NO3","NH4","CEC","POC",ag.cols,"TIC",
"MAOC","HB","HL","FWD",
"MB","PAB","HJB")
# run PCA
PCA = prcomp(~ TIC+POC+MAOC+CN+MWD+CEC+Sand+Clay+pH+P+K+Ca+Mg+TN+NO3+NH4+BD+Moisture+Temp+HL+FWD+MB+PAB+HJB,
data=df, scale=T, center=T)
eigenvalues <- PCA$sdev^2
plot(eigenvalues/sum(eigenvalues), type = "b",
xlab = "Principal Component",
ylab = "Percentage of Variance Explained", ylim=c(0,0.2))
round(eigenvalues/sum(eigenvalues)*100,2)
autoplot(PCA, x=1, y=4, data=df,
loadings=T, loadings.label=T, size=4, loadings.label.colour='black',
col="trt.full", shape="num", loadings.label.size=4,
loadings.label.vjust = -0.15, loadings.label.hjust = 0.1) +
labs(color="Treatment", shape="Plot")
# plot PCA with autoplot
df$trt.full = factor(df$trt.full, levels=trt.names)
df$num = factor(df$num)
autoplot(PCA, x=1, y=2, data=df,
loadings=T, loadings.label=T, size=4, loadings.label.colour='black',
col="trt.full", shape="num", loadings.label.size=4,
loadings.label.vjust = -0.15, loadings.label.hjust = 0.1) +
labs(color="Treatment", shape="Plot")
autoplot(PCA, x=1, y=3, data=df,
loadings=T, loadings.label=T, size=4, loadings.label.colour='black',
col="trt.full", shape="num", loadings.label.size=4,
loadings.label.vjust = -0.15, loadings.label.hjust = 0.1) +
labs(color="Treatment", shape="Plot")
autoplot(PCA, x=1, y=4, data=df,
loadings=T, loadings.label=T, size=4, loadings.label.colour='black',
col="trt.full", shape="num", loadings.label.size=4,
loadings.label.vjust = -0.15, loadings.label.hjust = 0.1) +
labs(color="Treatment", shape="Plot")
autoplot(PCA, x=1, y=2, data=df,
loadings=T, loadings.label=T, size=4, loadings.label.colour='black',
col="trt.full", shape="num", loadings.label.size=4,
loadings.label.vjust = -0.15, loadings.label.hjust = 0.1) +
labs(color="Treatment", shape="Plot")
# update column names
colnames(df)[6:40] = c("Temp","Moisture","BD","TN","TC","CN","TOC",
text.cols,"pH","P","K","Ca","Mg","SOM",
"NO3","NH4","CEC","POM-C",ag.cols,"TIC",
"MAOc","HB","HL","FWD",
"MB","PAB","HJB")
# run PCA
PCA = prcomp(~ TIC+`POM-C`+MAOC+CN+MWD+CEC+Sand+Clay+pH+P+K+Ca+Mg+TN+NO3+NH4+BD+Moisture+Temp+HL+FWD+MB+PAB+HJB,
data=df, scale=T, center=T)
# update column names
colnames(df)[6:40] = c("Temp","Moisture","BD","TN","TC","CN","TOC",
text.cols,"pH","P","K","Ca","Mg","SOM",
"NO3","NH4","CEC","POM-C",ag.cols,"TIC",
"MAOC","HB","HL","FWD",
"MB","PAB","HJB")
# run PCA
PCA = prcomp(~ TIC+`POM-C`+MAOC+CN+MWD+CEC+Sand+Clay+pH+P+K+Ca+Mg+TN+NO3+NH4+BD+Moisture+Temp+HL+FWD+MB+PAB+HJB,
data=df, scale=T, center=T)
# run PCA
PCA = prcomp(~ TIC+"POM-C"+MAOC+CN+MWD+CEC+Sand+Clay+pH+P+K+Ca+Mg+TN+NO3+NH4+BD+Moisture+Temp+HL+FWD+MB+PAB+HJB,
data=df, scale=T, center=T)
autoplot(PCA, x=1, y=3, data=df,
loadings=T, loadings.label=T, size=4, loadings.label.colour='black',
col="trt.full", shape="num", loadings.label.size=4,
loadings.label.vjust = -0.15, loadings.label.hjust = 0.1) +
labs(color="Treatment", shape="Plot")
autoplot(PCA, x=1, y=2, data=df,
loadings=T, loadings.label=T, size=4, loadings.label.colour='black',
col="trt.full", shape="num", loadings.label.size=4,
loadings.label.vjust = -0.15, loadings.label.hjust = 0.1) +
labs(color="Treatment", shape="Plot")
autoplot(PCA, x=1, y=3, data=df,
loadings=T, loadings.label=T, size=4, loadings.label.colour='black',
col="trt.full", shape="num", loadings.label.size=4,
loadings.label.vjust = -0.15, loadings.label.hjust = 0.1) +
labs(color="Treatment", shape="Plot")
autoplot(PCA, x=1, y=2, data=df,
loadings=T, loadings.label=T, size=4, loadings.label.colour='black',
col="trt.full", shape="num", loadings.label.size=4,
loadings.label.vjust = -0.15, loadings.label.hjust = 0.1) +
labs(color="Treatment", shape="Plot")
autoplot(PCA, x=1, y=3, data=df,
loadings=T, loadings.label=T, size=4, loadings.label.colour='black',
col="trt.full", shape="num", loadings.label.size=4,
loadings.label.vjust = -0.15, loadings.label.hjust = 0.1) +
labs(color="Treatment", shape="Plot")
autoplot(PCA, x=2, y=3, data=df,
loadings=T, loadings.label=T, size=4, loadings.label.colour='black',
col="trt.full", shape="num", loadings.label.size=4,
loadings.label.vjust = -0.15, loadings.label.hjust = 0.1) +
labs(color="Treatment", shape="Plot")
