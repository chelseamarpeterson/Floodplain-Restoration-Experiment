post.df.snag[k,"trt"] = trt.names[i]
post.df.snag[k,"spp"] = snag.spp[j]
post.df.snag[k,"mean"] = a.mean
post.df.snag[k,"5"] = a.hpdi.90[1]
post.df.snag[k,"95"] = a.hpdi.90[2]
post.df.snag[k,"25"] = a.hpdi.50[1]
post.df.snag[k,"75"] = a.hpdi.50[2]
k = k + 1
}
}
all.spp = sort(unique(post.df.snag$spp), decreasing=TRUE)
ggplot(post.df.snag, aes(x=factor(trt, levels=trt.names), fill=factor(spp, levels=all.spp), y=mean)) +
geom_bar(stat = "identity") +
labs(x="", y="Posterior mean of snag basal area (m2/ha)", fill="Species")
snag.melt = read.csv("Snag_Carbon_Stocks_By_Species.csv", header=T)
# convert treatment and species into id
snag.melt$tid = as.numeric(factor(snag.melt$trt))
snag.melt$spid = as.numeric(factor(snag.melt$species))
# make simplified data list
d.snag.sp = list(tid = snag.melt$tid,
spid = snag.melt$spid,
area = snag.melt$snag.carbonmin/mean(snag.melt$snag.carbonmin))
snag.mean = mean(snag.melt$snag.carbonmin)
#hist(log(d.snag.sp$area))
# fit simple model
set.seed(12)
snag.spp
as.numeric(factor(snag.melt$species))
factor(snag.melt$species)
levels(snag.melt$species)
levels(factor(snag.melt$species))
post.df.snag = data.frame(matrix(nrow=n.trt*n.spp, ncol=9))
colnames(post.df.snag) = c("tid","spid","trt","spp","mean","5","95","25","75")
k = 1
snag.spp = levels(factor(snag.melt$species))
for (i in 1:n.trt) {
for (j in 1:n.spp) {
a.mean = mean(a.snag[,i,j], 2)
a.hpdi.90 = HPDI(a.snag[,i,j], prob=0.90)
a.hpdi.50 = HPDI(a.snag[,i,j], prob=0.50)
post.df.snag[k,"tid"] = i
post.df.snag[k,"spid"] = j
post.df.snag[k,"trt"] = trt.names[i]
post.df.snag[k,"spp"] = snag.spp[j]
post.df.snag[k,"mean"] = a.mean
post.df.snag[k,"5"] = a.hpdi.90[1]
post.df.snag[k,"95"] = a.hpdi.90[2]
post.df.snag[k,"25"] = a.hpdi.50[1]
post.df.snag[k,"75"] = a.hpdi.50[2]
k = k + 1
}
}
# plot posteriors
all.spp = sort(unique(post.df.snag$spp), decreasing=TRUE)
ggplot(post.df.snag, aes(x=factor(trt, levels=trt.names), fill=factor(spp, levels=all.spp), y=mean)) +
geom_bar(stat = "identity") +
labs(x="", y="Posterior mean of snag basal area (m2/ha)", fill="Species")
ggplot(post.df.snag, aes(x=factor(trt, levels=trt.names),
fill=factor(spp, levels=snag.spp), y=mean)) +
geom_bar(stat = "identity") +
labs(x="", y="Posterior mean of snag basal area (m2/ha)", fill="Species")
# plot posteriors
cwd.spp = factor(cwd.melt$species)
cwd.spp = factor(cwd.melt$species)
ggplot(post.df.cwd, aes(x=factor(trt, levels=trt.names),
fill=factor(spp, levels=cwd.spp), y=mean)) +
geom_bar(stat = "identity") +
labs(x="",
y="Posterior mean of CWD [>= 7.6 cm] area (m2/km)",
fill="Species")
factor(cwd.melt$species)
cwd.spp = levels(factor(cwd.melt$species))
ggplot(post.df.cwd, aes(x=factor(trt, levels=trt.names),
fill=factor(spp, levels=cwd.spp), y=mean)) +
geom_bar(stat = "identity") +
labs(x="",
y="Posterior mean of CWD [>= 7.6 cm] area (m2/km)",
fill="Species")
post.cwd.sp = extract.samples(m.cwd.sp)
a.cwd = exp(post.cwd.sp$a)*mean.cwd
n.trt = 6
cwd.spp = levels(factor(cwd.melt$species))
n.spp.cwd = length(cwd.spp)
# create df with means and HPDIs by treatment and species
post.df.cwd = data.frame(matrix(nrow=n.trt*n.spp.cwd, ncol=9))
colnames(post.df.cwd) = c("tid","spid","trt","spp","mean","5","95","25","75")
k = 1
for (i in 1:n.trt) {
for (j in 1:n.spp.cwd) {
a.mean = mean(a.cwd[,i,j], 2)
a.hpdi.90 = HPDI(a.cwd[,i,j], prob=0.90)
a.hpdi.50 = HPDI(a.cwd[,i,j], prob=0.50)
post.df.cwd[k,"tid"] = i
post.df.cwd[k,"spid"] = j
post.df.cwd[k,"trt"] = trt.names[i]
post.df.cwd[k,"spp"] = cwd.spp[j]
post.df.cwd[k,"mean"] = a.mean
post.df.cwd[k,"5"] = a.hpdi.90[1]
post.df.cwd[k,"95"] = a.hpdi.90[2]
post.df.cwd[k,"25"] = a.hpdi.50[1]
post.df.cwd[k,"75"] = a.hpdi.50[2]
k = k + 1
}
}
# plot posteriors
ggplot(post.df.cwd, aes(x=factor(trt, levels=trt.names),
fill=factor(spp, levels=cwd.spp), y=mean)) +
geom_bar(stat = "identity") +
labs(x="",
y="Posterior mean of CWD [>= 7.6 cm] area (m2/km)",
fill="Species")
# prep dataframe
sp.C.dat = read.csv("Biomass_C_stocks_by_species.csv")
View(sp.C.dat)
sp.C.dat = read.csv("Biomass_C_stocks_by_species.csv")
sp.C.dat.2022 = sp.C.dat[which(sp.C.dat$year == 2022),
c("trt","num","genus","species","abC_ha3")]
sp.C.dat.2022$bmC = sp.C.dat.2022$abC_ha3
# make full species name column
sp.C.dat.2022 = unite(sp.C.dat.2022, col='spp', c('genus','species'), sep=' ')
View(sp.C.dat.2022)
# make wide df
sp.C.wide = pivot_wider(sp.C.dat.2022,
id_cols = c(trt, num),
names_from = spp,
values_from = bmC)
View(sp.C.wide)
sp.C.wide[is.na(sp.C.wide)] = 0
View(sp.C.wide)
sp.C.dat = read.csv("Biomass_C_stocks_by_species.csv")
sp.C.dat.2022 = sp.C.dat[which(sp.C.dat$year == 2022),
c("trt","num","genus","species","abC_ha3")]
sp.C.dat.2022$bmC = sp.C.dat.2022$abC_ha3
# make full species name column
sp.C.dat.2022 = unite(sp.C.dat.2022, col='spp', c('genus','species'), sep=' ')
# make wide df
sp.C.wide = pivot_wider(sp.C.dat.2022,
id_cols = c(trt, num),
names_from = spp,
values_from = bmC)
sp.C.wide[is.na(sp.C.wide)] = 0
View(sp.C.wide)
sp.C.melt = melt(sp.C.wide,
id.vars=c("trt","num"),
variable.name="spp")
View(sp.C.melt)
# convert treatments and species into indices
sp.C.wide$tid = as.numeric(factor(sp.C.wide$trt))
sp.C.melt$spid = as.numeric(factor(sp.C.melt$spp))
sp.C.dat = read.csv("Biomass_C_stocks_by_species.csv")
sp.C.dat.2022 = sp.C.dat[which(sp.C.dat$year == 2022),
c("trt","num","genus","species","abC_ha3")]
sp.C.dat.2022$bmC = sp.C.dat.2022$abC_ha3
# make full species name column
sp.C.dat.2022 = unite(sp.C.dat.2022, col='spp', c('genus','species'), sep=' ')
# make wide df
sp.C.wide = pivot_wider(sp.C.dat.2022,
id_cols = c(trt, num),
names_from = spp,
values_from = bmC)
sp.C.wide[is.na(sp.C.wide)] = 0
# reshape dataframe
sp.C.melt = melt(sp.C.wide,
id.vars=c("trt","num"),
variable.name="spp")
# convert treatments and species into indices
sp.C.melt$tid = as.numeric(factor(sp.C.melt$trt))
sp.C.melt$spid = as.numeric(factor(sp.C.melt$spp))
View(sp.C.melt)
d.bmC = list(tid = sp.C.melt$tid,
spid = sp.C.melt$spid,
bmC = sp.C.melt$value/mean(sp.C.melt$value))
mean.bmC = mean(sp.C.dat.2022$bmC)
View(d.bmC)
d.bmC = list(tid = sp.C.melt$tid,
spid = sp.C.melt$spid,
bmC = sp.C.melt$value/mean(sp.C.melt$value))
mean.bmC = mean(sp.C.melt$value)
# prep dataframe
sp.C.dat = read.csv("Biomass_C_stocks_by_species.csv")
sp.C.dat.2022 = sp.C.dat[which(sp.C.dat$year == 2022),
c("trt","num","genus","species","abC_ha3")]
# make full species name column
sp.C.dat.2022 = unite(sp.C.dat.2022, col='spp', c('genus','species'), sep=' ')
View(sp.C.dat.2022)
# make wide df
sp.C.wide = pivot_wider(sp.C.dat.2022,
id_cols = c(trt, num),
names_from = spp,
values_from = abC_ha3)
View(sp.C.wide)
sp.C.wide[is.na(sp.C.wide)] = 0
# reshape dataframe
sp.C.melt = melt(sp.C.wide,
id.vars=c("trt","num"),
variable.name="spp")
sp.C.melt$tid = as.numeric(factor(sp.C.melt$trt))
sp.C.melt$spid = as.numeric(factor(sp.C.melt$spp))
# make simplified data list
d.bmC = list(tid = sp.C.melt$tid,
spid = sp.C.melt$spid,
bmC = sp.C.melt$value/mean(sp.C.melt$value))
mean.bmC = mean(sp.C.melt$value)
set.seed(12)
m.bmC = ulam(alist(bmC ~ dnorm(mu, sigma),
log(mu) <- a[tid, spid],
matrix[tid, spid]:a ~ dnorm(0, 1),
sigma ~ dexp(1)),
data = d.bmC, chains=10)
post.bmC = extract.samples(m.bmC)
a.scale = exp(post.bmC$a) * mean.bmC
all.spp = levels(factor(sp.C.melt$spp))
n.spp = length(all.spp)
# create df with means and HPDIs by treatment and species
post.df.woodC = data.frame(matrix(nrow=n.trt*n.spp, ncol=9))
colnames(post.df.woodC) = c("tid","spid","trt","spp","mean","5","95","25","75")
k = 1
# plot posteriors
ggplot(post.df.woodC, aes(y=factor(trt, levels=trt.names),
fill=factor(spp, levels=all.spp), x=mean)) +
geom_bar(stat = "identity") +
labs(y="", x="Posterior mean of live woody C stocks (Mg/ha)", fill="Species")
View(post.df.woodC)
post.bmC = extract.samples(m.bmC)
a.scale = exp(post.bmC$a) * mean.bmC
all.spp = levels(factor(sp.C.melt$spp))
n.spp = length(all.spp)
# create df with means and HPDIs by treatment and species
post.df.woodC = data.frame(matrix(nrow=n.trt*n.spp, ncol=9))
colnames(post.df.woodC) = c("tid","spid","trt","spp","mean","5","95","25","75")
k = 1
for (i in 1:n.trt) {
for (j in 1:n.spp) {
a.mean = mean(a.scale[,i,j], 2)
a.sd = sd(a.scale[,i,j])
a.hpdi.90 = HPDI(a.scale[,i,j], prob=0.90)
a.hpdi.50 = HPDI(a.scale[,i,j], prob=0.50)
post.df.woodC[k,"tid"] = i
post.df.woodC[k,"spid"] = j
post.df.woodC[k,"trt"] = trt.names[i]
post.df.woodC[k,"spp"] = all.spp[j]
post.df.woodC[k,"mean"] = a.mean
post.df.woodC[k,"5"] = a.hpdi.90[1]
post.df.woodC[k,"95"] = a.hpdi.90[2]
post.df.woodC[k,"25"] = a.hpdi.50[1]
post.df.woodC[k,"75"] = a.hpdi.50[2]
k = k + 1
}
}
# plot posteriors
ggplot(post.df.woodC, aes(y=factor(trt, levels=trt.names),
fill=factor(spp, levels=all.spp), x=mean)) +
geom_bar(stat = "identity") +
labs(y="", x="Posterior mean of live woody C stocks (Mg/ha)", fill="Species")
factor(sp.C.melt$spp)
levels(factor(sp.C.melt$spp))
sort(levels(factor(sp.C.melt$spp)))
all.spp.sort = sort(levels(factor(sp.C.melt$spp)))
ggplot(post.df.woodC, aes(y=factor(trt, levels=trt.names),
fill=factor(spp, levels=all.spp.sort), x=mean)) +
geom_bar(stat = "identity") +
labs(y="", x="Posterior mean of live woody C stocks (Mg/ha)", fill="Species")
View(stem.sp.melt)
View(stem.sp.wide)
View(snag.count.sum)
View(snag.counts)
View(live.stem.sp.sum)
bm.vars = c("PA.C.g.m2","HJ.C.g.m2","mix.C.g.m2")
bm.sp = c("Phalaris arundinacea","Humulus japonicus","Mixed community")
# read in biomass C stock estimates
bm.dat = read.csv("All_Biomass_Variables.csv")
# read in biomass C stock estimates
bm.dat = read.csv("Clean_Cstocks_Richness.csv")
View(bm.dat)
# isolate biomass data for each species
bm.vars = c("PA.C.g.m2","HJ.C.g.m2","mix.C.g.m2")
bm.sp = c("Phalaris arundinacea","Humulus japonicus","Mixed community")
bm.sp.C.dat = bm.dat[,c("trt","trt.full","num",bm.vars)]
# isolate biomass data for each species
bm.vars = c("PA.C.Mg.ha","HJ.C.Mg.ha","mix.C.Mg.ha")
bm.sp = c("Phalaris arundinacea","Humulus japonicus","Mixed community")
bm.sp.C.dat = bm.dat[,c("trt","trt.full","num",bm.vars)]
View(bm.sp.C.dat)
bm.dat = read.csv("Clean_Cstocks_Richness.csv")
# isolate biomass data for each species
bm.vars = c("PA.C.Mg.ha","HJ.C.Mg.ha","mix.C.Mg.ha")
bm.sp = c("Phalaris arundinacea","Humulus japonicus","Mixed community")
bm.sp.C.dat = bm.dat[,c("trt","trt.full","num",bm.vars)]
colnames(bm.sp.C.dat)[4:6] = bm.sp
# melt dataframe
bm.sp.C.melt = melt(bm.sp.C.dat, id.vars=c("trt","trt.full","num"))
View(bm.sp.C.melt)
bm.dat = read.csv("Clean_Cstocks_Richness.csv")
# isolate biomass data for each species
bm.vars = c("PA.C.Mg.ha","HJ.C.Mg.ha","mix.C.Mg.ha")
bm.sp = c("Phalaris arundinacea","Humulus japonicus","Mixed community")
bm.sp.C.dat = bm.dat[,c("trt","trt.full","num",bm.vars)]
colnames(bm.sp.C.dat)[4:6] = bm.sp
# melt dataframe
bm.sp.C.melt = melt(bm.sp.C.dat, id.vars=c("trt","trt.full","num"))
View(bm.sp.C.melt)
# melt dataframe
bm.sp.C.melt = melt(bm.sp.C.dat,
id.vars=c("trt","trt.full","num"),
variable.name="species")
# convert treatmentinto indices
bm.sp.C.melt$tid = as.numeric(factor(bm.sp.C.melt$trt))
bm.sp.C.melt$spid = as.numeric(factor(bm.sp.C.melt$species))
d.bm = list(tid = as.integer(bm.sp.C.melt$tid),
spid = as.integer(bm.sp.C.melt$spid),
bm = bm.sp.C.melt$value/mean(bm.sp.C.melt$value))
set.seed(12)
m.bm.sp = ulam(alist(bm ~ dnorm(mu, sigma),
log(mu) <- a[tid, spid],
matrix[tid, spid]:a ~ dnorm(0, 1),
sigma ~ dexp(1)),
data = d.bm, chains=10)
bm.sp = levels(factor(bm.sp.C.melt$species))
bm.sp
post.bm.sp = extract.samples(m.bm.sp)
a.bm.sp = exp(post.bm.sp$a) * mean(bm.sp.C.melt$value)
n.trt = 6
bm.sp = levels(factor(bm.sp.C.melt$species))
n.spp.bm = 3
# create df with means and HPDIs by treatment and species
post.df.bm.sp = data.frame(matrix(nrow=n.trt*n.spp.bm, ncol=9))
colnames(post.df.bm.sp) = c("tid","spid","trt","spp","mean","5","95","25","75")
k = 1
for (i in 1:n.trt) {
for (j in 1:n.spp.bm) {
a.mean = mean(a.bm.sp[,i,j], 2)
a.hpdi.90 = HPDI(a.bm.sp[,i,j], prob=0.90)
a.hpdi.50 = HPDI(a.bm.sp[,i,j], prob=0.50)
post.df.bm.sp[k,"tid"] = i
post.df.bm.sp[k,"spid"] = j
post.df.bm.sp[k,"trt"] = trt.names[i]
post.df.bm.sp[k,"spp"] = bm.sp[j]
post.df.bm.sp[k,"mean"] = a.mean
post.df.bm.sp[k,"5"] = a.hpdi.90[1]
post.df.bm.sp[k,"95"] = a.hpdi.90[2]
post.df.bm.sp[k,"25"] = a.hpdi.50[1]
post.df.bm.sp[k,"75"] = a.hpdi.50[2]
k = k + 1
}
}
ggplot(post.df.bm.sp, aes(x=factor(trt, levels=trt.names),
fill=factor(spp, levels=bm.sp), y=mean)) +
geom_bar(stat = "identity") +
labs(x="", y="Posterior mean of herbaceous C stock (Mg/ha)", fill="Species group")
# plot posteriors
ggplot(post.df.bm.sp, aes(y=factor(trt, levels=trt.names),
fill=factor(spp, levels=bm.sp), x=mean)) +
geom_bar(stat = "identity") +
labs(x="", y="Posterior mean of herbaceous C stock (Mg/ha)", fill="Species group")
ggplot(post.df.bm.sp, aes(y=factor(trt, levels=trt.names),
fill=factor(spp, levels=bm.sp), x=mean)) +
geom_bar(stat = "identity") +
labs(y="", x="Posterior mean of herbaceous C stock (Mg/ha)", fill="Species group")
post.df.woodC$type = "Live woody C stock (Mg/ha)"
post.df.snag$type = "Snag area (m2/ha)"
post.df.cwd$type = "CWD area (m2/km)"
types = c("Live woody C stock (Mg/ha)","Snag area (m2/ha)",
"CWD area (m2/km)")
post.df.sp.all = rbind(post.df.woodC, post.df.snag, post.df.cwd, post.df.bm.sp)
## make combined color plot with live woody, snag/CWD area, and biomass stocks by species
post.df.woodC$type = "Live woody C stock (Mg/ha)"
View(post.df.woodC)
post.df.snag$type = "Snag area (m2/ha)"
View(post.df.snag)
post.df.cwd$type = "CWD area (m2/km)"
View(post.df.cwd)
post.df.woodC$type = "Live woody C stock (Mg/ha)"
post.df.snag$type = "Snag area (m2/ha)"
post.df.cwd$type = "CWD area (m2/km)"
types = c("Live woody C stock (Mg/ha)","Snag area (m2/ha)","CWD area (m2/km)")
post.df.sp.all = rbind(post.df.woodC, post.df.snag, post.df.cwd)
ggplot(post.df.sp.all, aes(x=mean, y=factor(trt, levels=trt.names),
fill=spp)) + geom_bar(stat="identity") +
facet_wrap(.~factor(type, levels=types), scales="free_x", ncol=1) +
labs(x="Posterior mean", y="", fill="Species") +
guides(fill=guide_legend(ncol =1))
all.sp = sort(unique(post.df.sp.all$spp))
post.df.sp.all = rbind(post.df.woodC, post.df.snag, post.df.cwd)
all.sp = sort(unique(post.df.sp.all$spp))
ggplot(post.df.sp.all, aes(x=mean, y=factor(trt, levels=trt.names),
fill=factor(spp, levels=all.sp))) +
geom_bar(stat="identity") +
facet_wrap(.~factor(type, levels=types), scales="free_x", ncol=1) +
labs(x="Posterior mean", y="", fill="Species") +
guides(fill=guide_legend(ncol =1))
all.sp
all.sp = sort(unique(trimws(post.df.sp.all$spp)))
ggplot(post.df.sp.all, aes(x=mean, y=factor(trt, levels=trt.names),
fill=factor(spp, levels=all.sp))) +
geom_bar(stat="identity") +
facet_wrap(.~factor(type, levels=types), scales="free_x", ncol=1) +
labs(x="Posterior mean", y="", fill="Species") +
guides(fill=guide_legend(ncol =1))
post.df.sp.all = rbind(post.df.woodC, post.df.snag, post.df.cwd)
post.df.sp.all$spp = trimws(post.df.sp.all$spp)
all.sp = sort(unique(post.df.sp.all$spp))
ggplot(post.df.sp.all, aes(x=mean, y=factor(trt, levels=trt.names),
fill=factor(spp, levels=all.sp))) +
geom_bar(stat="identity") +
facet_wrap(.~factor(type, levels=types), scales="free_x", ncol=1) +
labs(x="Posterior mean", y="", fill="Species") +
guides(fill=guide_legend(ncol =1))
post.df.woodC$type = "Live tree C stock (\u2265 2 cm)"
post.df.snag$type = "Minimum standing dead tree C stock (\u2265 2 cm)"
post.df.cwd$type = "Coarse woody debris (\u2265 7.6 cm)"
types = c("Live tree C stock (\u2265 2 cm)",
"Minimum standing dead tree C stock (\u2265 2 cm)",
"Coarse woody debris (\u2265 7.6 cm)")
post.df.sp.all = rbind(post.df.woodC, post.df.snag, post.df.cwd)
post.df.sp.all$spp = trimws(post.df.sp.all$spp)
all.sp = sort(unique(post.df.sp.all$spp))
ggplot(post.df.sp.all, aes(x=mean, y=factor(trt, levels=trt.names),
fill=factor(spp, levels=all.sp))) +
geom_bar(stat="identity") +
facet_wrap(.~factor(type, levels=types), scales="free_x", ncol=1) +
labs(x="Posterior mean (Mg/ha)", y="", fill="Species") +
guides(fill=guide_legend(ncol=1))
post.df.woodC$type = "Live tree C stock (\u2265 2 cm)"
post.df.snag$type = "Minimum standing dead tree C stock (\u2265 2 cm)"
post.df.cwd$type = "Coarse woody debris (\u2265 7.6 cm)"
types = c("Live trees (\u2265 2 cm)",
"Minimum for standing dead trees (\u2265 2 cm)",
"Coarse woody debris (\u2265 7.6 cm)")
post.df.sp.all = rbind(post.df.woodC, post.df.snag, post.df.cwd)
post.df.sp.all$spp = trimws(post.df.sp.all$spp)
all.sp = sort(unique(post.df.sp.all$spp))
ggplot(post.df.sp.all, aes(x=mean, y=factor(trt, levels=trt.names),
fill=factor(spp, levels=all.sp))) +
geom_bar(stat="identity") +
facet_wrap(.~factor(type, levels=types), scales="free_x", ncol=1) +
labs(x="Posterior mean C stock (Mg/ha)", y="", fill="Species") +
guides(fill=guide_legend(ncol=1))
post.df.woodC$type = "Live trees(\u2265 2 cm)"
post.df.snag$type = "Minimum for standing dead trees (\u2265 2 cm)"
post.df.cwd$type = "Coarse woody debris (\u2265 7.6 cm)"
types = c("Live trees (\u2265 2 cm)",
"Minimum for standing dead trees (\u2265 2 cm)",
"Coarse woody debris (\u2265 7.6 cm)")
post.df.sp.all = rbind(post.df.woodC, post.df.snag, post.df.cwd)
post.df.sp.all$spp = trimws(post.df.sp.all$spp)
all.sp = sort(unique(post.df.sp.all$spp))
ggplot(post.df.sp.all, aes(x=mean, y=factor(trt, levels=trt.names),
fill=factor(spp, levels=all.sp))) +
geom_bar(stat="identity") +
facet_wrap(.~factor(type, levels=types), scales="free_x", ncol=1) +
labs(x="Posterior mean C stock (Mg/ha)", y="", fill="Species") +
guides(fill=guide_legend(ncol=1))
post.df.woodC$type = "Live trees (\u2265 2 cm)"
post.df.snag$type = "Minimum for standing dead trees (\u2265 2 cm)"
post.df.cwd$type = "Coarse woody debris (\u2265 7.6 cm)"
types = c("Live trees (\u2265 2 cm)",
"Minimum for standing dead trees (\u2265 2 cm)",
"Coarse woody debris (\u2265 7.6 cm)")
post.df.sp.all = rbind(post.df.woodC, post.df.snag, post.df.cwd)
post.df.sp.all$spp = trimws(post.df.sp.all$spp)
all.sp = sort(unique(post.df.sp.all$spp))
ggplot(post.df.sp.all, aes(x=mean, y=factor(trt, levels=trt.names),
fill=factor(spp, levels=all.sp))) +
geom_bar(stat="identity") +
facet_wrap(.~factor(type, levels=types), scales="free_x", ncol=1) +
labs(x="Posterior mean C stock (Mg/ha)", y="", fill="Species") +
guides(fill=guide_legend(ncol=1))
post.df.woodC$type = "Live trees (\u2265 2.5 cm)"
post.df.snag$type = "Minimum for standing dead trees (\u2265 2.5 cm)"
post.df.cwd$type = "Coarse woody debris (\u2265 7.6 cm)"
types = c("Live trees (\u2265 2 cm)",
"Minimum for standing dead trees (\u2265 2 cm)",
"Coarse woody debris (\u2265 7.6 cm)")
post.df.sp.all = rbind(post.df.woodC, post.df.snag, post.df.cwd)
post.df.sp.all$spp = trimws(post.df.sp.all$spp)
all.sp = sort(unique(post.df.sp.all$spp))
ggplot(post.df.sp.all, aes(x=mean, y=factor(trt, levels=trt.names),
fill=factor(spp, levels=all.sp))) +
geom_bar(stat="identity") +
facet_wrap(.~factor(type, levels=types), scales="free_x", ncol=1) +
labs(x="Posterior mean C stock (Mg/ha)", y="", fill="Species") +
guides(fill=guide_legend(ncol=1))
post.df.woodC$type = "Live trees (\u2265 2.5 cm)"
post.df.snag$type = "Minimum for standing dead trees (\u2265 2.5 cm)"
post.df.cwd$type = "Coarse woody debris (\u2265 7.6 cm)"
types = c("Live trees (\u2265 2.5 cm)",
"Minimum for standing dead trees (\u2265 2.5 cm)",
"Coarse woody debris (\u2265 7.6 cm)")
post.df.sp.all = rbind(post.df.woodC, post.df.snag, post.df.cwd)
post.df.sp.all$spp = trimws(post.df.sp.all$spp)
all.sp = sort(unique(post.df.sp.all$spp))
ggplot(post.df.sp.all, aes(x=mean, y=factor(trt, levels=trt.names),
fill=factor(spp, levels=all.sp))) +
geom_bar(stat="identity") +
facet_wrap(.~factor(type, levels=types), scales="free_x", ncol=1) +
labs(x="Posterior mean C stock (Mg/ha)", y="", fill="Species") +
guides(fill=guide_legend(ncol=1))
post.df.woodC$type = "Live trees (\u2265 2.5 cm)"
post.df.snag$type = "Standing dead trees (\u2265 2.5 cm)"
post.df.cwd$type = "Coarse woody debris (\u2265 7.6 cm)"
types = c("Live trees (\u2265 2.5 cm)",
"Standing dead trees (\u2265 2.5 cm)",
"Coarse woody debris (\u2265 7.6 cm)")
post.df.sp.all = rbind(post.df.woodC, post.df.snag, post.df.cwd)
post.df.sp.all$spp = trimws(post.df.sp.all$spp)
all.sp = sort(unique(post.df.sp.all$spp))
ggplot(post.df.sp.all, aes(x=mean, y=factor(trt, levels=trt.names),
fill=factor(spp, levels=all.sp))) +
geom_bar(stat="identity") +
facet_wrap(.~factor(type, levels=types), scales="free_x", ncol=1) +
labs(x="Posterior mean C stock (Mg/ha)", y="", fill="Species") +
guides(fill=guide_legend(ncol=1))
