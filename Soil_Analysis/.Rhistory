col="trt.full", shape="num", loadings.label.size=4,
loadings.label.vjust = -0.15, loadings.label.hjust = 0.1) +
labs(color="Treatment", shape="Plot")
autoplot(PCA, x=2, y=3, data=df,
loadings=T, loadings.label=T, size=4, loadings.label.colour='black',
col="trt.full", shape="num", loadings.label.size=4,
loadings.label.vjust = -0.15, loadings.label.hjust = 0.1) +
labs(color="Treatment", shape="Plot")
autoplot(PCA, x=1, y=4, data=df,
loadings=T, loadings.label=T, size=4, loadings.label.colour='black',
col="trt.full", shape="num", loadings.label.size=4,
loadings.label.vjust = -0.15, loadings.label.hjust = 0.1) +
labs(color="Treatment", shape="Plot")
# look at rotation vectors
summary(PCA)
PCA$rotation[,1:5]
sort(PCA$rotation[,1]) # Silt/BD - SOM/CEC
sort(PCA$rotation[,2]) # Sand - Silt - Clay/P
sort(PCA$rotation[,3]) # Clay/sand - CEC/Silt
# Percentage of variance explained
eigenvalues <- PCA$sdev^2
plot(eigenvalues/sum(eigenvalues), type = "b",
xlab = "Principal Component",
ylab = "Percentage of Variance Explained", ylim=c(0,0.2))
round(eigenvalues/sum(eigenvalues)*100,2)
round(cumsum(eigenvalues/sum(eigenvalues)*100),2)
## plot PCA with ggplot/ggrepel
#PCA loadings
PCAloadings <- data.frame(Variables = rownames(PCA$rotation), PCA$rotation)
# add PCA scores to the dataset
df[, c('PC1','PC2','PC3')] = PCA$x[, 1:3]
# save variable loadings in a separate dataset
rot = as.data.frame(PCA$rotation[, 1:3])
rot$var = rownames(PCA$rotation)
# rescale the loadings to fit nicely within the scatterplot of our data
mult = max(abs(df[, c('PC1','PC2','PC3')])) / max(abs(rot[, 1:3])) / 2
rot[, 1:3] = rot[, 1:3] * mult
ggplot(data=rot,
aes(x=0, y=0, xend=PC1, yend=PC3, label=var)) +
geom_point(data=df, aes(x=PC1, y=PC3, color=trt.full, shape=num),
inherit.aes=FALSE, size=3) +
geom_segment(color='red', arrow=arrow(length=unit(0.03,"npc"))) +
geom_label_repel(aes(PC1 * 1.001, PC3 * 1.001)) +
theme_bw() + labs(color="Treatment", shape="Plot") +
scale_y_continuous(limits=c(-4,4)) +
scale_x_continuous(limits=c(-4,4)) +
labs(x="PC1 (16.9%)",y="PC3 (10.7%)") +
theme(text = element_text(size=14),
panel.grid = element_blank()) +
geom_mark_hull(aes(trt.full), alpha = 0.3)
ggplot(data=rot,
aes(x=0, y=0, xend=PC1, yend=PC3, label=var)) +
geom_point(data=df, aes(x=PC1, y=PC3, color=trt.full, shape=num),
inherit.aes=FALSE, size=3)
ggplot(data=rot,
aes(x=0, y=0, xend=PC1, yend=PC3, label=var)) +
geom_point(data=df, aes(x=PC1, y=PC3, color=trt.full, shape=num),
inherit.aes=FALSE, size=3) +
geom_mark_hull(data=df, aes(trt.full), alpha = 0.3)
ggplot(data=rot,
aes(x=0, y=0, xend=PC1, yend=PC3, label=var)) +
geom_point(data=df, aes(x=PC1, y=PC3, color=trt.full, shape=num),
inherit.aes=FALSE, size=3) +
geom_mark_hull(data=df, aes(fill=trt.full, alpha=0.3) +
geom_segment(color='red', arrow=arrow(length=unit(0.03,"npc"))) +
geom_label_repel(aes(PC1 * 1.001, PC3 * 1.001)) +
theme_bw() + labs(color="Treatment", shape="Plot") +
scale_y_continuous(limits=c(-4,4)) +
scale_x_continuous(limits=c(-4,4)) +
labs(x="PC1 (16.9%)",y="PC3 (10.7%)") +
theme(text = element_text(size=14),
panel.grid = element_blank())
ggplot(data=rot,
aes(x=0, y=0, xend=PC1, yend=PC3, label=var)) +
geom_point(data=df, aes(x=PC1, y=PC3, color=trt.full, shape=num),
inherit.aes=FALSE, size=3) +
geom_mark_hull(data=df, aes(fill=trt.full, alpha=0.3) +
geom_segment(color='red', arrow=arrow(length=unit(0.03,"npc"))) +
geom_label_repel(aes(PC1 * 1.001, PC3 * 1.001)) +
theme_bw() + labs(color="Treatment", shape="Plot") +
scale_y_continuous(limits=c(-4,4)) +
scale_x_continuous(limits=c(-4,4)) +
labs(x="PC1 (16.9%)",y="PC3 (10.7%)") +
theme(text = element_text(size=14),
panel.grid = element_blank())
ggplot(data=rot,
aes(x=0, y=0, xend=PC1, yend=PC3, label=var)) +
geom_point(data=df, aes(x=PC1, y=PC3, color=trt.full, shape=num),
inherit.aes=FALSE, size=3) +
geom_mark_hull(data=df, aes(fill=trt.full, alpha=0.3)) +
geom_segment(color='red', arrow=arrow(length=unit(0.03,"npc"))) +
geom_label_repel(aes(PC1 * 1.001, PC3 * 1.001)) +
theme_bw() + labs(color="Treatment", shape="Plot") +
scale_y_continuous(limits=c(-4,4)) +
scale_x_continuous(limits=c(-4,4)) +
labs(x="PC1 (16.9%)",y="PC3 (10.7%)") +
theme(text = element_text(size=14),
panel.grid = element_blank())
ggplot(data=rot, aes(x=0, y=0, xend=PC1, yend=PC3, label=var)) +
geom_segment(color='red', arrow=arrow(length=unit(0.03,"npc")))
ggplot(data=rot, aes(x=0, y=0, xend=PC1, yend=PC3, label=var)) +
geom_segment(color='red', arrow=arrow(length=unit(0.03,"npc"))) +
geom_point(data=df, aes(x=PC1, y=PC3, color=trt.full, shape=num),
inherit.aes=FALSE, size=3)
ggplot(data=rot, aes(x=0, y=0, xend=PC1, yend=PC3, label=var)) +
geom_segment(color='red', arrow=arrow(length=unit(0.03,"npc"))) +
geom_label_repel(aes(PC1 * 1.001, PC3 * 1.001)) +
geom_point(data=df, aes(x=PC1, y=PC3, color=trt.full, shape=num),
inherit.aes=FALSE, size=3) +
geom_mark_hull(aes(fill = factor(trt.full)), alpha = 0.2)
ggplot(data=rot, aes(x=0, y=0, xend=PC1, yend=PC3, label=var)) +
geom_segment(color='red', arrow=arrow(length=unit(0.03,"npc"))) +
geom_label_repel(aes(PC1 * 1.001, PC3 * 1.001)) +
geom_point(data=df, aes(x=PC1, y=PC3, color=trt.full, shape=num),
inherit.aes=FALSE, size=3) +
geom_mark_hull(data=df, aes(fill = factor(trt.full)), alpha = 0.2)
?geom_mark_hull
ggplot(data=rot, aes(x=0, y=0, xend=PC1, yend=PC3, label=var)) +
geom_segment(color='red', arrow=arrow(length=unit(0.03,"npc"))) +
geom_label_repel(aes(PC1 * 1.001, PC3 * 1.001)) +
geom_point(data=df, aes(x=PC1, y=PC3, color=trt.full, shape=num),
inherit.aes=FALSE, size=3) +
geom_mark_hull(data=df, aes(fill=trt.full, label=trt.full), alpha = 0.2)
ggplot(data=rot, aes(x=0, y=0, xend=PC1, yend=PC3, label=var)) +
geom_segment(color='red', arrow=arrow(length=unit(0.03,"npc"))) +
geom_label_repel(aes(PC1 * 1.001, PC3 * 1.001)) +
geom_point(data=df, aes(x=PC1, y=PC3, color=trt.full, shape=num),
inherit.aes=FALSE, size=3) +
geom_mark_hull(data=df, aes(fill=trt.full), alpha = 0.2)
ggplot(df, aes(x=PC1, y=PC3, color=trt.full)) +
geom_mark_hull(aes(fill=trt.full, label=trt.full)) +
geom_point()
ggplot(df, aes(x=PC1, y=PC3, color=trt.full)) +
geom_mark_hull(aes(fill=trt.full)) +
geom_point()
ggplot(df, aes(x=PC1, y=PC3, color=trt.full, shape=num)) +
geom_mark_hull(aes(fill=trt.full)) +
geom_point()
ggplot(df, aes(x=PC1, y=PC3, color=trt.full)) +
geom_mark_hull(aes(fill=trt.full)) +
geom_point()
ggplot(df, aes(x=PC1, y=PC3, color=trt.full)) +
geom_mark_hull(aes(fill=trt.full), concavity=1) +
geom_point()
ggplot(df, aes(x=PC1, y=PC2, color=trt.full)) +
geom_mark_hull(aes(fill=trt.full), concavity=1) +
geom_point()
ggplot(df, aes(x=PC1, y=PC3, color=trt.full)) +
geom_mark_hull(aes(fill=trt.full), concavity=1) +
geom_point()
ggplot(df, aes(x=PC2, y=PC3, color=trt.full)) +
geom_mark_hull(aes(fill=trt.full), concavity=1) +
geom_point()
ggplot(df, aes(x=PC1, y=PC3, color=trt.full)) +
geom_mark_hull(aes(fill=trt.full), concavity=10) +
geom_point()
ggplot(df, aes(x=PC1, y=PC3, color=trt.full)) +
geom_mark_hull(aes(fill=trt.full), concavity=100) +
geom_point()
ggplot(df, aes(x=PC1, y=PC2, color=trt.full)) +
geom_mark_hull(aes(fill=trt.full), concavity=100) +
geom_point()
ggplot(df, aes(x=PC1, y=PC3, color=trt.full)) +
geom_mark_hull(aes(fill=trt.full), concavity=100) +
geom_point()
ggplot(df, aes(x=PC2, y=PC3, color=trt.full)) +
geom_mark_hull(aes(fill=trt.full), concavity=100) +
geom_point()
ggplot(data=rot, aes(x=0, y=0, xend=PC1, yend=PC3, label=var)) +
geom_segment(color='red', arrow=arrow(length=unit(0.03,"npc"))) +
geom_label_repel(aes(PC1 * 1.001, PC3 * 1.001)) +
geom_point(data=df, aes(x=PC1, y=PC3, color=trt.full),
inherit.aes=FALSE, size=3) +
geom_mark_hull(data=df, aes(fill=trt.full), alpha = 0.2)
ggplot(df, aes(x=PC1, y=PC3, color=trt.full)) +
geom_mark_hull(aes(fill=trt.full), concavity=100) +
geom_point()
round(cumsum(eigenvalues/sum(eigenvalues)*100),2)
path_to_soil_folder = "C:/Users/Chels/OneDrive - University of Illinois - Urbana/Chapter2/Floodplain-Experiment-Repo/Soil_Analysis"
setwd(path_to_soil_folder)
library(ggplot2)
library(patchwork)
library(RColorBrewer)
################################################################################
### plot Bayesian model results for soil properties
# treatment names
trts = c("A","B","C","D","E","R")
trt.names = c("Balled-and-burlapped","Bareroot","Seedling","Acorn","Seedbank","Reference")
# variable labels
var.labels = c("SOM (%)","TOC (%)","TIC (%)","POC (%)","MAOC (%)","TC (%)","TN (%)","C:N Ratio",
"Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"Sand (%)","Silt (%)","Clay (%)","NO3 (ppm)","NH4 (ppm)","P (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)","K (meq)","Ca (meq)","Mg (meq)",
"CEC (meq/100 g)","pH","Floating POM",
">4.75 mm","2 - 4.75 mm","250 \u03bcm - 2 mm","53 - 250 \u03bcm",
"<53 \u03bcm","Mean-weight diameter (mm)")
# read in HPDIs
df.int = read.csv("Posteriors/All_Soil_Posterior_Intervals_ChainCount5.csv")
# print results for tables
i = 33
cbind(df.int[which(df.int$v == var.labels[i]),c("v","t")],
round(df.int[which(df.int$v == var.labels[i]),c("mean","X5","X95")],1))
cbind(df.int[which(df.int$v == var.labels[i]),c("v","t")],
round(df.int[which(df.int$v == var.labels[i]),c("mean","X5","X95")],2))
cbind(df.int[which(df.int$v == var.labels[i]),c("v","t")],
round(df.int[which(df.int$v == var.labels[i]),c("mean","X5","X95")],3))
# plot all variables
ggplot(df.int, aes(y=factor(t, levels=trt.names),
x=mean)) +
geom_errorbarh(aes(xmin=X5, xmax=X95), color="black") +
geom_errorbarh(aes(xmin=X25, xmax=X75), color="blue") +
geom_point() +
facet_wrap(.~v, scales="free_x",ncol=5)
106.3-88
104.8-88
113.0-88
117.1-88
98.9-88
89.1-88
88.3-88
91.5-88
# plot variables on absolute scale
vars = c("TN (%)","C:N Ratio","Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"Sand (%)","Silt (%)","Clay (%)","NO3 (ppm)","NH4 (ppm)","P (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)","CEC (meq/100 g)","pH",
">4.75 mm","2 - 4.75 mm","250 \u03bcm - 2 mm","53 - 250 \u03bcm",
"<53 \u03bcm","Mean-weight diameter (mm)")
df.plot = df.int[which(df.int$v %in% vars),]
df.plot$lab = rep(0, nrow(df.plot))
for (i in 1:length(vars)) { df.plot$lab[which(df.plot$v == vars[i])] = var.labels[i] }
p.chem.phys = ggplot(df.plot,
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`X5`, xmax=`X95`),
width=0.25, color="black",
position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(lab, levels=var.labels),
scales="free_x", ncol=3) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="Posterior estimate") +
theme(text = element_text(size=12))
p.chem.phys
View(df.int)
vars = c("TN (%)","C:N Ratio","Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"Sand (%)","Silt (%)","Clay (%)","NO3 (ppm)","NH4 (ppm)","P (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)","CEC (meq/100 g)","pH",
">4.75 mm","2 - 4.75 mm","250 \u03bcm - 2 mm","53 - 250 \u03bcm",
"<53 \u03bcm","Mean-weight diameter (mm)")
df.plot = df.int[which(df.int$v %in% vars),]
p.chem.phys = ggplot(df.plot,
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`X5`, xmax=`X95`),
width=0.25, color="black",
position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=var.labels),
scales="free_x", ncol=3) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="Posterior estimate") +
theme(text = element_text(size=12))
p.chem.phys
p.chem.phys = ggplot(df.plot,
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`X5`, xmax=`X95`),
width=0.25, color="black",
position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=var.labels),
scales="free_x", ncol=4) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="Posterior estimate") +
theme(text = element_text(size=12))
p.chem.phys
p.chem.phys = ggplot(df.plot,
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`X5`, xmax=`X95`),
width=0.25, color="black",
position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=var.labels),
scales="free_x", ncol=5) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="Posterior estimate") +
theme(text = element_text(size=12))
p.chem.phys
vars = c("Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"Sand (%)","Silt (%)","Clay (%)","pH",
"TN (%)","C:N Ratio","NO3 (ppm)","NH4 (ppm)","P (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)","CEC (meq/100 g)",
">4.75 mm","2 - 4.75 mm","250 \u03bcm - 2 mm","53 - 250 \u03bcm",
"<53 \u03bcm","Mean-weight diameter (mm)")
df.plot = df.int[which(df.int$v %in% vars),]
p.chem.phys = ggplot(df.plot,
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`X5`, xmax=`X95`),
width=0.25, color="black",
position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=var.labels),
scales="free_x", ncol=4) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="Posterior estimate") +
theme(text = element_text(size=12))
p.chem.phys
vars = c("Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"Sand (%)","Silt (%)","Clay (%)","pH",
"TN (%)","C:N Ratio","NO3 (ppm)","NH4 (ppm)","P (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)","CEC (meq/100 g)",
">4.75 mm","2 - 4.75 mm","250 \u03bcm - 2 mm","53 - 250 \u03bcm",
"<53 \u03bcm","Mean-weight diameter (mm)")
df.plot = df.int[which(df.int$v %in% vars),]
p.chem.phys = ggplot(df.plot,
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`X5`, xmax=`X95`),
width=0.25, color="black",
position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=vars),
scales="free_x", ncol=4) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="Posterior estimate") +
theme(text = element_text(size=12))
p.chem.phys
vars = c("Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)","pH",
"Sand (%)","Silt (%)","Clay (%)",
"TN (%)","C:N Ratio","NO3 (ppm)","NH4 (ppm)","P (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)","CEC (meq/100 g)",
">4.75 mm","2 - 4.75 mm","250 \u03bcm - 2 mm","53 - 250 \u03bcm",
"<53 \u03bcm","Mean-weight diameter (mm)")
df.plot = df.int[which(df.int$v %in% vars),]
p.chem.phys = ggplot(df.plot,
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`X5`, xmax=`X95`),
width=0.25, color="black",
position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=vars),
scales="free_x", ncol=4) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="Posterior estimate") +
theme(text = element_text(size=12))
p.chem.phys
vars = c("Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"Mean-weight diameter (mm)","pH","Sand (%)","Silt (%)","Clay (%)",
"TN (%)","C:N Ratio","NO3 (ppm)","NH4 (ppm)","P (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)","CEC (meq/100 g)",
">4.75 mm","2 - 4.75 mm","250 \u03bcm - 2 mm","53 - 250 \u03bcm",
"<53 \u03bcm")
df.plot = df.int[which(df.int$v %in% vars),]
p.chem.phys = ggplot(df.plot,
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`X5`, xmax=`X95`),
width=0.25, color="black",
position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=vars),
scales="free_x", ncol=4) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="Posterior estimate") +
theme(text = element_text(size=12))
p.chem.phys
vars = c("Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"Mean-weight diameter (mm)","pH","Sand (%)","Silt (%)","Clay (%)",
"TN (%)","C:N Ratio","NO3 (ppm)","NH4 (ppm)","P (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)","CEC (meq/100 g)",
">4.75 mm","2 - 4.75 mm","250 \u03bcm - 2 mm","53 - 250 \u03bcm",
"<53 \u03bcm")
df.plot = df.int[which(df.int$v %in% vars),]
p.chem.phys = ggplot(df.plot,
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`X5`, xmax=`X95`),
width=0.25, color="black",
position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=vars),
scales="free_x", ncol=5) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="Posterior estimate") +
theme(text = element_text(size=12))
p.chem.phys
p.chem.phys = ggplot(df.plot,
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`X5`, xmax=`X95`),
width=0.25, color="black",
position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=vars),
scales="free_x", ncol=4) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="Posterior estimate") +
theme(text = element_text(size=12))
p.chem.phys
vars = c("Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"pH","Sand (%)","Silt (%)","Clay (%)",
"TN (%)","C:N Ratio","NO3 (ppm)","NH4 (ppm)","P (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)",">4.75 mm","2 - 4.75 mm",
"250 \u03bcm - 2 mm","53 - 250 \u03bcm","<53 \u03bcm")
df.plot = df.int[which(df.int$v %in% vars),]
p.chem.phys = ggplot(df.plot,
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`X5`, xmax=`X95`),
width=0.25, color="black",
position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=vars),
scales="free_x", ncol=4) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="Posterior estimate") +
theme(text = element_text(size=12))
p.chem.phys
p.chem.phys = ggplot(df.plot,
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`X5`, xmax=`X95`),
width=0.25, color="black",
position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=vars),
scales="free_x", ncol=5) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="Posterior estimate") +
theme(text = element_text(size=12))
p.chem.phys
vars = c("Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"Sand (%)","Silt (%)","Clay (%)","TN (%)","C:N Ratio",
"pH","NO3 (ppm)","NH4 (ppm)","P (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)",">4.75 mm","2 - 4.75 mm",
"250 \u03bcm - 2 mm","53 - 250 \u03bcm","<53 \u03bcm")
df.plot = df.int[which(df.int$v %in% vars),]
p.chem.phys = ggplot(df.plot,
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`X5`, xmax=`X95`),
width=0.25, color="black",
position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=vars),
scales="free_x", ncol=5) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="Posterior estimate") +
theme(text = element_text(size=12))
p.chem.phys
vars = c("Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"TN (%)","C:N Ratio","Sand (%)","Silt (%)","Clay (%)",
"pH","NO3 (ppm)","NH4 (ppm)","P (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)",">4.75 mm","2 - 4.75 mm",
"250 \u03bcm - 2 mm","53 - 250 \u03bcm","<53 \u03bcm")
df.plot = df.int[which(df.int$v %in% vars),]
p.chem.phys = ggplot(df.plot,
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`X5`, xmax=`X95`),
width=0.25, color="black",
position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=vars),
scales="free_x", ncol=5) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="Posterior estimate") +
theme(text = element_text(size=12))
p.chem.phys
ggsave("Figures/Figure4_Nutrients_BD_Temp_Moisture_pH.jpeg",
plot=p.chem.phys,width=17.5,height=15,units="cm",dpi=600)
vars = c("Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"TN (%)","C:N Ratio","Sand (%)","Silt (%)","Clay (%)",
"pH","P (ppm)","NO3 (ppm)","NH4 (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)",">4.75 mm","2 - 4.75 mm",
"250 \u03bcm - 2 mm","53 - 250 \u03bcm","<53 \u03bcm")
df.plot = df.int[which(df.int$v %in% vars),]
p.chem.phys = ggplot(df.plot,
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`X5`, xmax=`X95`),
width=0.25, color="black",
position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=vars),
scales="free_x", ncol=5) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="Posterior estimate") +
theme(text = element_text(size=12))
p.chem.phys
ggsave("Figures/Figure4_All_Except_CEC_MWD.jpeg",
plot=p.chem.phys,width=17.5,height=15,units="cm",dpi=600)
ggsave("Figures/Figure4_All_Except_CEC_MWD.jpeg",
plot=p.chem.phys,width=20,height=15,units="cm",dpi=600)
ggsave("Figures/Figure4_All_Except_CEC_MWD.jpeg",
plot=p.chem.phys,width=25,height=15,units="cm",dpi=600)
ggsave("Figures/Figure4_All_Except_CEC_MWD.jpeg",
plot=p.chem.phys,width=27,height=18,units="cm",dpi=600)
p.chem.phys = ggplot(df.plot,
aes(y=factor(t, levels=trt.names), x=mean)) +
geom_errorbar(aes(xmin=`X5`, xmax=`X95`),
width=0.25, color="black",
position=position_dodge(width=0.5)) +
geom_point(size=1, position=position_dodge(width=0.5)) +
facet_wrap(.~factor(v, levels=vars),
scales="free_x", ncol=5) +
theme(panel.spacing.x = unit(0.4, "cm")) +
labs(y="",x="Posterior estimate") +
theme(text = element_text(size=12))  +
scale_x_continuous(breaks = breaks_pretty(n=4))
install.packages("scales")
install.packages("scales")
vars = c("Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"TN (%)","C:N Ratio","Sand (%)","Silt (%)","Clay (%)",
"pH","P (ppm)","NO3 (ppm)","NH4 (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)",">4.75 mm","2 - 4.75 mm",
"250 \u03bcm - 2 mm","53 - 250 \u03bcm","<53 \u03bcm")
labs = c("Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"TN (%)","C:N Ratio","Sand (%)","Silt (%)","Clay (%)",
"pH","P (ppm)","NO3-N (ppm)","NH4-N (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)",">4.75 mm","2 - 4.75 mm",
"250 \u03bcm - 2 mm","53 - 250 \u03bcm","<53 \u03bcm")
library(ggtext)
library(scales)
