"upper" = apply(du.pred.df, 2, function(x) HPDI(x, prob=0.95))[2,])
pred.sum = rbind(nwi.pred.sum, du.pred.sum)
ggplot(pred.sum, aes(x=log(area),y=mean,fill=dataset)) +
geom_line() +
geom_ribbon(aes(x=log(area),ymin=lower,ymax=upper),alpha=0.5) +
scale_fill_manual(values=c("Original NWI"="forestgreen",
"Ducks Unlimited"="steelblue4"))
scale_fill_manual(values=c("Original NWI"="forestgreen",
"Ducks Unlimited"="steelblue4"))
ggplot(pred.sum, aes(x=log(area),y=mean,fill=dataset)) +
geom_line() +
geom_ribbon(aes(x=log(area),ymin=lower,ymax=upper),alpha=0.5) +
labs(x="Log(Polygon area [Ha])",y="Probability of commission error",
fill="Dataset") +
scale_fill_manual(values=c("Original NWI"="forestgreen",
"Ducks Unlimited"="steelblue4"))
min(nwi.df$Shape_Area)/10^4
min(du.df$Shape_Area)/10^4
max(nwi.df$Shape_Area)/10^4
max(du.df$Shape_Area)/10^4
n = 1000
nwi.areas = seq(0.01, 1200, length.out=n)
du.areas = seq(0.01, 1200, length.out=n)
nwi.pred.df = data.frame(matrix(nrow=500,ncol=n))
du.pred.df = data.frame(matrix(nrow=500,ncol=n))
for (i in 1:n) {
nwi.pred.df[1:500,i] = inv_logit(nwi.samples$a + nwi.samples$b*nwi.areas[i])
du.pred.df[1:500,i] = inv_logit(du.samples$a + du.samples$b*du.areas[i])
}
nwi.pred.sum = data.frame("dataset" = "Original NWI",
"area" = nwi.areas,
"mean" = apply(nwi.pred.df, 2, FUN=mean),
"lower" = apply(nwi.pred.df, 2, function(x) HPDI(x, prob=0.95))[1,],
"upper" = apply(nwi.pred.df, 2, function(x) HPDI(x, prob=0.95))[2,])
du.pred.sum = data.frame("dataset" = "Ducks Unlimited",
"area" = du.areas,
"mean" = apply(du.pred.df, 2, FUN=mean),
"lower" = apply(du.pred.df, 2, function(x) HPDI(x, prob=0.95))[1,],
"upper" = apply(du.pred.df, 2, function(x) HPDI(x, prob=0.95))[2,])
pred.sum = rbind(nwi.pred.sum, du.pred.sum)
ggplot(pred.sum, aes(x=log(area),y=mean,fill=dataset)) +
geom_line() +
geom_ribbon(aes(x=log(area),ymin=lower,ymax=upper),alpha=0.5) +
labs(x="Log(Polygon area [Ha])",y="Probability of commission error",
fill="Dataset") +
scale_fill_manual(values=c("Original NWI"="forestgreen",
"Ducks Unlimited"="steelblue4"))
ggplot(commission.county.df,
aes(y=Proj_County, x=commission_rate)) +
geom_bar(stat="identity") +
labs(x = "Commission rate", y="County or County Group")
ggplot(commission.type.df,
aes(y=NWI_Code_Simple, x=commission_rate)) +
geom_bar(stat="identity") +
labs(x = "Commission rate", y="NWI Cowardin Class")
setwd("C:/Users/Chels/OneDrive - University of Illinois - Urbana/Illinois Wetlands Risk Assessment/Databases/INHS Database Data")
library(readxl)
library(tidyr)
# read in dataframes
nwi.df = read.csv("INHS_WS_Step4_NonDeep_Intersect.csv")
du.df = read.csv("INHS_DU_Step4_NonDeep_Intersect.csv")
# create wetland yes/no field
nwi.df$wetland.yn = (nwi.df$WetLand == "Yes")
du.df$wetland.yn = (du.df$WetLand == "Yes")
nwi.df$ones = rep(1, nrow(nwi.df))
du.df$ones = rep(1, nrow(du.df))
# estimate commission rate by wetland type
nwi.type.stats = nwi.df %>%
group_by(WETLAND_TY) %>%
summarize(correct_rate = sum(wetland.yn)/sum(ones),
commission_rate = sum(1-wetland.yn)/sum(ones))
du.type.stats = du.df %>%
group_by(WETLAND_TY) %>%
summarize(correct_rate = sum(wetland.yn)/sum(ones),
commission_rate = sum(1-wetland.yn)/sum(ones))
nwi.type.stats$dataset = "Original NWI"
du.type.stats$dataset = "Ducks Unlimited"
all.type.stats = rbind(nwi.type.stats,du.type.stats)
# plot commission rate as a function of class name and dataset
ggplot(all.type.stats, aes(x=commission_rate,
y=WETLAND_TY,
fill=dataset)) +
geom_bar(stat="identity",position="dodge") +
scale_fill_manual(values=c("Original NWI"="forestgreen",
"Ducks Unlimited"="steelblue4"))
all.type.stats = all.type.stats[-which(all.type.stats$WETLAND_TY == "Lake"),]
ggplot(all.type.stats, aes(x=commission_rate,
y=WETLAND_TY,
fill=dataset)) +
geom_bar(stat="identity",position="dodge") +
scale_fill_manual(values=c("Original NWI"="forestgreen",
"Ducks Unlimited"="steelblue4"))
ggplot(all.type.stats, aes(x=commission_rate,
y=WETLAND_TY,
fill=dataset)) +
geom_bar(stat="identity",position="dodge") +
labs(y="",x="Commission error rate") +
scale_fill_manual(values=c("Original NWI"="forestgreen",
"Ducks Unlimited"="steelblue4"))
ggplot(all.type.stats, aes(x=commission_rate,
y=WETLAND_TY,
fill=dataset)) +
geom_bar(stat="identity",position="dodge",
fill="Dataset") +
labs(y="",x="Commission error rate") +
scale_fill_manual(values=c("Original NWI"="forestgreen",
"Ducks Unlimited"="steelblue4"))
ggplot(all.type.stats, aes(x=commission_rate,
y=WETLAND_TY,
fill=dataset)) +
geom_bar(stat="identity",position="dodge",
fill="Dataset") +
labs(y="",x="Commission error rate") +
scale_fill_manual(values=c("Original NWI"="forestgreen",
"Ducks Unlimited"="steelblue4"))
# read in dataframes
nwi.df = read.csv("INHS_WS_Step4_NonDeep_Intersect.csv")
du.df = read.csv("INHS_DU_Step4_NonDeep_Intersect.csv")
# create wetland yes/no field
nwi.df$wetland.yn = (nwi.df$WetLand == "Yes")
du.df$wetland.yn = (du.df$WetLand == "Yes")
nwi.df$ones = rep(1, nrow(nwi.df))
du.df$ones = rep(1, nrow(du.df))
# estimate commission rate by wetland type
nwi.type.stats = nwi.df %>%
group_by(WETLAND_TY) %>%
summarize(correct_rate = sum(wetland.yn)/sum(ones),
commission_rate = sum(1-wetland.yn)/sum(ones))
du.type.stats = du.df %>%
group_by(WETLAND_TY) %>%
summarize(correct_rate = sum(wetland.yn)/sum(ones),
commission_rate = sum(1-wetland.yn)/sum(ones))
nwi.type.stats$dataset = "Original NWI"
du.type.stats$dataset = "Ducks Unlimited"
all.type.stats = rbind(nwi.type.stats,du.type.stats)
# plot commission rate as a function of class name and dataset
all.type.stats = all.type.stats[-which(all.type.stats$WETLAND_TY == "Lake"),]
ggplot(all.type.stats, aes(x=commission_rate,
y=WETLAND_TY,
fill=dataset)) +
geom_bar(stat="identity",position="dodge",
fill="Dataset") +
labs(y="",x="Commission error rate") +
scale_fill_manual(values=c("Original NWI"="forestgreen",
"Ducks Unlimited"="steelblue4"))
ggplot(all.type.stats, aes(x=commission_rate,
y=WETLAND_TY,
fill=dataset)) +
geom_bar(stat="identity",position="dodge") +
labs(y="",x="Commission error rate",fill="Dataset") +
scale_fill_manual(values=c("Original NWI"="forestgreen",
"Ducks Unlimited"="steelblue4"))
nwi.class.stats = nwi.df %>%
group_by(CLASS_NAME) %>%
summarize(correct_rate = sum(wetland.yn)/sum(ones),
commission_rate = sum(1-wetland.yn)/sum(ones))
du.class.stats = du.df %>%
group_by(CLASS_NAME) %>%
summarize(correct_rate = sum(wetland.yn)/sum(ones),
commission_rate = sum(1-wetland.yn)/sum(ones))
nwi.class.stats$dataset = "Original NWI"
du.class.stats$dataset = "Ducks Unlimited"
all.class.stats = rbind(nwi.class.stats,du.class.stats)
# plot commission rate as a function of class name and dataset
ggplot(all.class.stats, aes(x=commission_rate,
y=CLASS_NAME,
fill=dataset)) +
geom_bar(stat="identity",position="dodge") +
scale_fill_manual(values=c("Original NWI"="forestgreen",
"Ducks Unlimited"="steelblue4"))
View(all.class.stats)
scale_fill_manual(values=c("Original NWI"="forestgreen",
"Ducks Unlimited"="steelblue4"))
# plot commission rate as a function of class name and dataset
ggplot(all.class.stats, aes(x=commission_rate,
y=CLASS_NAME,
fill=dataset)) +
geom_bar(stat="identity",position="dodge") +
labs(y="Class name",x="Commission error rate",fill="Dataset") +
scale_fill_manual(values=c("Original NWI"="forestgreen",
"Ducks Unlimited"="steelblue4"))
nwi.wr.stats = nwi.df %>%
group_by(WATER_REGI) %>%
summarize(correct_rate = sum(wetland.yn)/sum(ones),
commission_rate = sum(1-wetland.yn)/sum(ones))
du.wr.stats = du.df %>%
group_by(WATER_REGI) %>%
summarize(correct_rate = sum(wetland.yn)/sum(ones),
commission_rate = sum(1-wetland.yn)/sum(ones))
nwi.wr.stats$dataset = "Original NWI"
du.wr.stats$dataset = "Ducks Unlimited"
all.wr.stats = rbind(nwi.wr.stats,du.wr.stats)
# plot commission rate as a function of class name and dataset
ggplot(all.wr.stats, aes(x=commission_rate,
y=WATER_REGI,
fill=dataset)) +
geom_bar(stat="identity",position="dodge") +
labs(y="Water regime",x="Commission error rate",fill="Dataset") +
scale_fill_manual(values=c("Original NWI"="forestgreen",
"Ducks Unlimited"="steelblue4"))
sort(unique(nwi.df$FIRST_MODI))
path_to_soil_folder = "C:/Users/Chels/OneDrive - University of Illinois - Urbana/Ch1/Public-Repo/Soil_Analysis"
setwd(path_to_soil_folder)
library(ggplot2)
library(patchwork)
library(RColorBrewer)
################################################################################
### plot Bayesian model results for soil properties
# treatment names
trts = c("A","B","C","D","E","R")
trt.names = c("Balled-and-burlapped","Bareroot","Seedling","Acorn","Seedbank","Reference")
# variable labels
var.labels = c("SOM (%)","TOC (%)","TIC (%)","POM-C (%)","MAOM-C (%)","TC (%)","TN (%)","C:N Ratio",
"Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"Sand (%)","Silt (%)","Clay (%)","NO3 (ppm)","NH4 (ppm)","P (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)","K (meq)","Ca (meq)","Mg (meq)",
"CEC (meq/100 g)","pH","Floating POM",
">4.75 mm","2 - 4.75 mm","250 \u03bcm - 2 mm","53 - 250 \u03bcm",
"<53 \u03bcm","Mean-weight diameter (mm)")
# read in HPDIs
df.int = read.csv("Posteriors/All_Soil_Posterior_Intervals_ChainCount5.csv")
# print results for tables
cbind(df.int[which(df.int$v == var.labels[6]),c("v","t")],
round(df.int[which(df.int$v == var.labels[6]),c("mean","X5","X95")],2))
ggplot(df.int, aes(y=factor(t, levels=trt.names),
x=mean)) +
geom_errorbarh(aes(xmin=X5, xmax=X95), color="black") +
geom_errorbarh(aes(xmin=X25, xmax=X75), color="blue") +
geom_point() +
facet_wrap(.~v, scales="free_x",ncol=5)
#path_to_soil_folder = "C:/Users/Chels/OneDrive - University of Illinois - Urbana/Ch1/Public-Repo/Soil_Analysis"
path_to_soil_folder = "C:/Users/cmptrsn2/OneDrive - University of Illinois - Urbana/Ch1/Public-Repo/Soil_Analysis"
setwd(path_to_soil_folder)
path_to_soil_folder = "C:/Users/Chels/OneDrive - University of Illinois - Urbana/Ch1/Public-Repo/Soil_Analysis"
#path_to_soil_folder = "C:/Users/cmptrsn2/OneDrive - University of Illinois - Urbana/Ch1/Public-Repo/Soil_Analysis"
setwd(path_to_soil_folder)
library(ggplot2)
library(patchwork)
library(RColorBrewer)
################################################################################
### plot Bayesian model results for soil properties
# treatment names
trts = c("A","B","C","D","E","R")
trt.names = c("Balled-and-burlapped","Bareroot","Seedling","Acorn","Seedbank","Reference")
# variable labels
var.labels = c("SOM (%)","TOC (%)","TIC (%)","POM-C (%)","MAOM-C (%)","TC (%)","TN (%)","C:N Ratio",
"Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"Sand (%)","Silt (%)","Clay (%)","NO3 (ppm)","NH4 (ppm)","P (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)","K (meq)","Ca (meq)","Mg (meq)",
"CEC (meq/100 g)","pH","Floating POM",
">4.75 mm","2 - 4.75 mm","250 \u03bcm - 2 mm","53 - 250 \u03bcm",
"<53 \u03bcm","Mean-weight diameter (mm)")
# read in HPDIs
df.int = read.csv("Posteriors/All_Soil_Posterior_Intervals_ChainCount5.csv")
# print results for tables
cbind(df.int[which(df.int$v == var.labels[6]),c("v","t")],
round(df.int[which(df.int$v == var.labels[6]),c("mean","X5","X95")],2))
ggplot(df.int, aes(y=factor(t, levels=trt.names),
x=mean)) +
geom_errorbarh(aes(xmin=X5, xmax=X95), color="black") +
geom_errorbarh(aes(xmin=X25, xmax=X75), color="blue") +
geom_point() +
facet_wrap(.~v, scales="free_x",ncol=5)
path_to_soil_folder = "C:/Users/Chels/OneDrive - University of Illinois - Urbana/Ch1/Public-Repo/Soil_Data"
setwd(path_to_soil_folder)
path_to_soil_folder = "C:/Users/Chels/OneDrive - University of Illinois - Urbana/Ch1/Public-Repo/Soil_Analysis"
setwd(path_to_soil_folder)
library(rethinking)
library(dplyr)
library(reshape2)
# set seed
set.seed(2718)
# treatment names
trts = c("A","B","C","D","E","R")
trt.names = c("Balled-and-burlapped","Bareroot","Seedling","Acorn","Seedbank","Reference")
# read in soil data
soil.dat = read.csv("Clean_Data/All_Soil_Data_2023.csv", header=T)
# labels
ag.cols = c("fpom","g475mm","g2mm","g250um","g53um","l53um","mwd")
meq.cols = c("k.meq","ca.meq","mg.meq","h.meq")
text.cols  = c("sand","silt","clay")
# variables to omit
leave.out = c("ton","pon")
soil.dat = soil.dat[,-which(colnames(soil.dat) %in% leave.out)]
# update column names
colnames(soil.dat)[6:9] = c("temp","gmoist","vmoist","bd")
soil.dat$gmoist = soil.dat$gmoist * 100
# make index for treatment, quadrat, and plot number
soil.dat$tid = as.numeric(factor(soil.dat$trt))
soil.dat$qid = as.numeric(factor(soil.dat$quad))
soil.dat$pid = rep(0, nrow(soil.dat))
k = 1
for (t in 1:6) {
for (p in 1:3) {
tp.ind = which(soil.dat$tid == t & soil.dat$num == p)
soil.dat$pid[tp.ind] = k
k = k + 1
}
}
# isolate fpom data
fpom.dat = soil.dat[-which(is.na(soil.dat$fpom)),
c("plot","trt","trt.full","num","quad","fpom")]
# make index for treatment, quadrat, and plot number
fpom.dat$tid = as.numeric(factor(fpom.dat$trt))
fpom.dat$qid = as.numeric(factor(fpom.dat$quad))
fpom.dat$pid = rep(0, nrow(fpom.dat))
k = 1
for (t in 1:6) {
for (p in 1:3) {
tp.ind = which(fpom.dat$tid == t & fpom.dat$num == p)
fpom.dat$pid[tp.ind] = k
k = k + 1
}
}
# add maoc:poc ratio
soil.dat$maoc_poc = soil.dat$maoc/soil.dat$poc
# make simple list for Bayes analysis
vars = c("som","bulk.n","bulk.c","bulk.cn","toc","poc","tic","maoc",
"temp","gmoist","vmoist","bd",
"ph","p","k","ca","mg","no3","nh4","cec",
text.cols,meq.cols[1:3],ag.cols,"maoc_poc00")
n.v = length(vars)
all.lists = list()
all.means = list()
n.v
vars[34]
# make simple list for Bayes analysis
vars = c("som","bulk.n","bulk.c","bulk.cn","toc","poc","tic","maoc",
"temp","gmoist","vmoist","bd",
"ph","p","k","ca","mg","no3","nh4","cec",
text.cols,meq.cols[1:3],ag.cols,"maoc_poc")
vars[34]
i = 34
n.v = length(vars)
all.lists = list()
all.means = list()
v = vars[i]
all.means[[v]] = mean(soil.dat[,v])
d.v =  list(tid=as.integer(soil.dat$tid),
pid=as.integer(soil.dat$num),
y=soil.dat[,v])
d.v$y = d.v$y/mean(d.v$y)
all.lists[[v]] = d.v
vars = c("som","bulk.n","bulk.c","bulk.cn","toc","poc","tic","maoc",
"temp","gmoist","vmoist","bd",
"ph","p","k","ca","mg","no3","nh4","cec",
text.cols,meq.cols[1:3],ag.cols,"maoc_poc")
n.v = length(vars)
all.lists = list()
all.means = list()
for (i in 1:n.v) {
v = vars[i]
if (v == "fpom") {
all.means[[v]] = mean(fpom.dat[,v])
d.v =  list(tid=as.integer(fpom.dat$tid),
pid=as.integer(fpom.dat$num),
y=fpom.dat[,v])
} else {
all.means[[v]] = mean(soil.dat[,v])
d.v =  list(tid=as.integer(soil.dat$tid),
pid=as.integer(soil.dat$num),
y=soil.dat[,v])
}
d.v$y = d.v$y/mean(d.v$y)
all.lists[[v]] = d.v
}
# model code w/ random effect
soil.models2 = list()
vars2 = c("bulk.c","toc","tic","maoc")
var.labels2 = c("TC (%)","TOC (%)","TIC (%)","MAOM-C (%)")
i  = 34
# model code w/ random effect
soil.models2 = list()
vars2 = c("bulk.c","toc","tic","maoc")
var.labels2 = c("TC (%)","TOC (%)","TIC (%)","MAOM-C (%)")
v = vars[i]
m.v = ulam(alist(y ~ normal(mu, sigma),
log(mu) <- a[tid] + b[tid, pid],
a[tid] ~ dnorm(0, 1),
matrix[tid, pid]: b ~ dnorm(0, sigma_b),
sigma_b ~ dexp(1),
sigma ~ dexp(1)),
data=all.lists[[v]], chains=5, log_lik=T)
soil.models2[[v]] = m.v
all.samples = list()
all.a = list()
all.sig = list()
v = vars2[i]
all.samples[[v]] = extract.samples(soil.models2[[v]])
soil.models2
all.samples = list()
all.a = list()
all.sig = list()
i = 34
v = vars2[i]
all.samples[[v]] = extract.samples(soil.models2[[v]])
v = vars[i]
all.samples[[v]] = extract.samples(soil.models2[[v]])
all.a[[v]] = exp(all.samples[[v]]$a) * all.means[[v]]
all.sig[[v]] = exp(all.samples[[v]]$sigma) * all.means[[v]]
# variable labels
var.order = c("som","toc","tic","poc","maoc","bulk.c","bulk.n","bulk.cn",
"temp","gmoist","bd",text.cols,"no3","nh4","p","k","ca","mg",
meq.cols[1:3],"cec","ph",ag.cols,"MAOC.POC")
var.labels = c("SOM (%)","TOC (%)","TIC (%)","POM-C (%)","MAOM-C (%)","TC (%)","TN (%)","C:N Ratio",
"Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"Sand (%)","Silt (%)","Clay (%)","NO3 (ppm)","NH4 (ppm)","P (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)","K (meq)","Ca (meq)","Mg (meq)",
"CEC (meq/100 g)","pH","Floating POM",
">4.75 mm","2 - 4.75 mm","250 \u03bcm - 2 mm","53 - 250 \u03bcm",
"<53 \u03bcm","Mean-weight diameter (mm)","MAOC:POC ratio")
# variable labels
var.order = c("som","toc","tic","poc","maoc","bulk.c","bulk.n","bulk.cn",
"temp","gmoist","bd",text.cols,"no3","nh4","p","k","ca","mg",
meq.cols[1:3],"cec","ph",ag.cols,"MAOC.POC")
var.labels = c("SOM (%)","TOC (%)","TIC (%)","POM-C (%)","MAOM-C (%)","TC (%)","TN (%)","C:N Ratio",
"Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"Sand (%)","Silt (%)","Clay (%)","NO3 (ppm)","NH4 (ppm)","P (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)","K (meq)","Ca (meq)","Mg (meq)",
"CEC (meq/100 g)","pH","Floating POM",
">4.75 mm","2 - 4.75 mm","250 \u03bcm - 2 mm","53 - 250 \u03bcm",
"<53 \u03bcm","Mean-weight diameter (mm)","MAOC:POC ratio")
n.v.plot = length(var.order)
# get posterior intervals and write to file
df.int = data.frame(matrix(nrow=0, ncol=10))
colnames(df.int) = c("v","t","mean","sd","5","95","15","85","25","75")
i = 34
n.v.plot
i = 33
df.v = data.frame(matrix(nrow=6, ncol=10))
colnames(df.v) = c("v","t","mean","sd","5","95","15","85","25","75")
# get posterior intervals and write to file
df.int = data.frame(matrix(nrow=0, ncol=10))
colnames(df.int) = c("v","t","mean","sd","5","95","15","85","25","75")
# get posterior intervals and write to file
df.int = data.frame(matrix(nrow=0, ncol=10))
colnames(df.int) = c("v","t","mean","sd","5","95","15","85","25","75")
df.v = data.frame(matrix(nrow=6, ncol=10))
colnames(df.v) = c("v","t","mean","sd","5","95","15","85","25","75")
v = var.order[i]
a.means = apply(all.a[[v]], 2, mean)
v
var.order = c("som","toc","tic","poc","maoc","bulk.c","bulk.n","bulk.cn",
"temp","gmoist","bd",text.cols,"no3","nh4","p","k","ca","mg",
meq.cols[1:3],"cec","ph",ag.cols,"maoc_poc")
var.labels = c("SOM (%)","TOC (%)","TIC (%)","POM-C (%)","MAOM-C (%)","TC (%)","TN (%)","C:N Ratio",
"Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"Sand (%)","Silt (%)","Clay (%)","NO3 (ppm)","NH4 (ppm)","P (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)","K (meq)","Ca (meq)","Mg (meq)",
"CEC (meq/100 g)","pH","Floating POM",
">4.75 mm","2 - 4.75 mm","250 \u03bcm - 2 mm","53 - 250 \u03bcm",
"<53 \u03bcm","Mean-weight diameter (mm)","MAOC:POC ratio")
n.v.plot = length(var.order)
# get posterior intervals and write to file
df.int = data.frame(matrix(nrow=0, ncol=10))
colnames(df.int) = c("v","t","mean","sd","5","95","15","85","25","75")
i
df.v = data.frame(matrix(nrow=6, ncol=10))
colnames(df.v) = c("v","t","mean","sd","5","95","15","85","25","75")
v = var.order[i]
a.means = apply(all.a[[v]], 2, mean)
a.sds = apply(all.a[[v]], 2, sd)
a.hpdi.90 = apply(all.a[[v]], 2, HPDI, prob=0.90)
a.hpdi.70 = apply(all.a[[v]], 2, HPDI, prob=0.70)
a.hpdi.50 = apply(all.a[[v]], 2, HPDI, prob=0.50)
df.v[1:6,"v"] = var.labels[i]
df.v[1:6,"t"] = trt.names
df.v[1:6,"mean"] = a.means
df.v[1:6,"sd"] = a.sds
df.v[1:6,"5"] = a.hpdi.90[1,]
df.v[1:6,"95"] = a.hpdi.90[2,]
df.v[1:6,"15"] = a.hpdi.70[1,]
df.v[1:6,"85"] = a.hpdi.70[2,]
df.v[1:6,"25"] = a.hpdi.50[1,]
df.v[1:6,"75"] = a.hpdi.50[2,]
#df.int[which(df.int$v == var.labels2[i]),] = df.v
df.int = rbind(df.int, df.v)
View(df.int)
ggplot(df.int, aes(y=t, x=mean)) + geom_point()
ggplot(df.int, aes(y=t, x=mean)) +
geom_point() +
geom_errorbarh(aes(y=t, xmin=`5`, xmax=`95`))
path_to_soil_folder = "C:/Users/Chels/OneDrive - University of Illinois - Urbana/Ch1/Public-Repo/Soil_Analysis"
#path_to_soil_folder = "C:/Users/cmptrsn2/OneDrive - University of Illinois - Urbana/Ch1/Public-Repo/Soil_Analysis"
setwd(path_to_soil_folder)
library(ggplot2)
library(patchwork)
library(RColorBrewer)
################################################################################
### plot Bayesian model results for soil properties
# treatment names
trts = c("A","B","C","D","E","R")
trt.names = c("Balled-and-burlapped","Bareroot","Seedling","Acorn","Seedbank","Reference")
# variable labels
var.labels = c("SOM (%)","TOC (%)","TIC (%)","POM-C (%)","MAOM-C (%)","TC (%)","TN (%)","C:N Ratio",
"Temperature (C)","Gravitational moisture (%)","Bulk density (g/cm3)",
"Sand (%)","Silt (%)","Clay (%)","NO3 (ppm)","NH4 (ppm)","P (ppm)",
"K (ppm)","Ca (ppm)","Mg (ppm)","K (meq)","Ca (meq)","Mg (meq)",
"CEC (meq/100 g)","pH","Floating POM",
">4.75 mm","2 - 4.75 mm","250 \u03bcm - 2 mm","53 - 250 \u03bcm",
"<53 \u03bcm","Mean-weight diameter (mm)")
# read in HPDIs
df.int = read.csv("Posteriors/All_Soil_Posterior_Intervals_ChainCount5.csv")
# print results for tables
cbind(df.int[which(df.int$v == var.labels[6]),c("v","t")],
round(df.int[which(df.int$v == var.labels[6]),c("mean","X5","X95")],2))
ggplot(df.int, aes(y=factor(t, levels=trt.names),
x=mean)) +
geom_errorbarh(aes(xmin=X5, xmax=X95), color="black") +
geom_errorbarh(aes(xmin=X25, xmax=X75), color="blue") +
geom_point() +
facet_wrap(.~v, scales="free_x",ncol=5)
